{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - MalSilo - 2.0.1",
      "description": "Sample playbooks for \"MalSilo\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "playbook_logo.png",
      "uuid": "dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
      "id": 56,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1649740284.363801,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1649740284.363801,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get IP Feeds",
          "aliasName": null,
          "tag": null,
          "description": "Get IP Feeds from MalSilo",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1649227681,
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f8dc9861-17b3-4bad-be45-23537a017f43",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get IP Feeds",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "config": "71786850-ce25-4493-afad-8817c441ced6",
                "params": {
                  "last_pull_time": "{% if globalVars.MalSiloLastPullTime %}{{ globalVars.MalSiloLastPullTime }}{% else %}{{ arrow.utcnow().timestamp }}{% endif %}"
                },
                "version": "2.0.1",
                "connector": "malsilo",
                "operation": "get_ipv4_feed",
                "operationTitle": "Get IPv4 Feeds",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "135",
              "left": "193",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "a48d2563-bbd1-4c83-854d-31221aa3d32c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "79f6952c-32b3-4cf6-813b-ad7b8924a3c8",
                "title": "Get MalSilo IP Feeds",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "f8dc9861-17b3-4bad-be45-23537a017f43"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get IP Feeds",
              "targetStep": "/api/3/workflow_steps/a48d2563-bbd1-4c83-854d-31221aa3d32c",
              "sourceStep": "/api/3/workflow_steps/f8dc9861-17b3-4bad-be45-23537a017f43",
              "label": null,
              "isExecuted": false,
              "uuid": "09eae1ba-f4c4-405c-b841-ec5afc732df8"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "03951cfc-57aa-4faf-a133-115ee61c98a3",
          "id": 509,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1649740284.365194,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1649740284.365194,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "malsilo"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "MalSilo > Ingest",
          "aliasName": null,
          "tag": "#malsilo4 #dataIngestion #ingest",
          "description": "Data Ingestion Playbook",
          "isActive": false,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1649740960,
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b0af6dd7-5aae-4680-b69e-f22ce15419dd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "b0af6dd7-5aae-4680-b69e-f22ce15419dd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/9634df50-4ed5-45f0-a9ed-ad578a1e6a55"
              },
              "status": null,
              "top": "111",
              "left": "200",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "60aba241-933c-43d6-80f1-1d37d06c9b89"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.steps.Fetch.lastPullTimeMacro}}",
                  "value": "{{vars.steps.Fetch.lastPullTime}}"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "280",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "fe3b84f2-480d-44bf-9989-b8e04d769c78"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create",
              "description": null,
              "arguments": {
                "arguments": {
                  "expiry": "{{vars.steps.Fetch.expiry}}",
                  "confidence": "{{vars.steps.Fetch.confidence}}",
                  "lastPullTime": "{{vars.steps.Fetch.lastPullTime}}",
                  "threat_feeds": "{{vars.steps.Fetch.data}}",
                  "tlp_resolved": "{{vars.steps.Fetch.tlp_resolved}}",
                  "reputation_resolved": "{{vars.steps.Fetch.reputation_resolved}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/ef459fff-30b0-4de5-936a-21337b312e68"
              },
              "status": null,
              "top": "200",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "2a4acd5c-1b6d-48f9-a5cb-55766a5052ba"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch",
              "targetStep": "/api/3/workflow_steps/60aba241-933c-43d6-80f1-1d37d06c9b89",
              "sourceStep": "/api/3/workflow_steps/b0af6dd7-5aae-4680-b69e-f22ce15419dd",
              "label": null,
              "isExecuted": false,
              "uuid": "ff71b3f2-27c6-49b4-bfa9-58e61170f55b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch -> Create 1",
              "targetStep": "/api/3/workflow_steps/2a4acd5c-1b6d-48f9-a5cb-55766a5052ba",
              "sourceStep": "/api/3/workflow_steps/60aba241-933c-43d6-80f1-1d37d06c9b89",
              "label": null,
              "isExecuted": false,
              "uuid": "c8150b28-0ac5-434a-8647-71a1ffd4976b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create 1 -> Update Last Pull Time",
              "targetStep": "/api/3/workflow_steps/fe3b84f2-480d-44bf-9989-b8e04d769c78",
              "sourceStep": "/api/3/workflow_steps/2a4acd5c-1b6d-48f9-a5cb-55766a5052ba",
              "label": null,
              "isExecuted": false,
              "uuid": "48e75899-004f-491b-8069-27024ff124b1"
            }
          ],
          "priority": null,
          "uuid": "254deff6-13d0-4ef0-bdcc-9e38aa19521d",
          "id": 510,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1649740284.365926,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1649740959.623314,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "malsilo"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> MalSilo > Fetch",
          "aliasName": null,
          "tag": "#malsilo #dataingestion #fetch",
          "description": "Data Ingestion Playbook",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1649743312,
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d29b8219-0763-4171-9d44-6a66d35d67fd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "tlp": "White",
                "expiry": "30",
                "tlp_map": "{'Red': \"{{'TrafficLightProtocol' | picklist('Red', 'uuid')}}\",'Amber':\"{{'TrafficLightProtocol' | picklist('Amber', 'uuid')}}\",'Green':\"{{'TrafficLightProtocol' | picklist('Green','uuid')}}\",'White': \"{{'TrafficLightProtocol' | picklist('White', 'uuid')}}\"}",
                "fetchTime": "{{arrow.utcnow().timestamp}}",
                "confidence": "50",
                "reputation": "Suspicious",
                "reputation_map": "{'Good': \"{{'IndicatorReputation' | picklist('Good', 'uuid')}}\",'Suspicious': \"{{'IndicatorReputation' | picklist('Suspicious', 'uuid')}}\",'Malicious': \"{{'IndicatorReputation' | picklist('Malicious', 'uuid')}}\",'No Reputation Available': \"{{'IndicatorReputation' | picklist('No Reputation Available', 'uuid')}}\",'TBD': \"{{'IndicatorReputation' | picklist('TBD', 'uuid')}}\"}",
                "macroNameForLastPullTime": "MalSiloLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "140",
              "left": "151",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "bcced530-f04c-415f-a766-651c5e1f91ec"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Type of feeds to ingest\",\n    \"name\": \"feedtypes\",\n    \"type\": \"multiselect\",\n    \"tooltip\": \"Select one or more types you want to pull from the MalSilo feeds list\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\n      \"IP\",\n      \"Domain\",\n      \"URL\"\n    ],\n    \"options\": [\"IP\", \"Domain\", \"URL\"],\n    \"value\": [\"IP\", \"Domain\", \"URL\"]\n  },\n{\n    \"title\": \"Confidence\",\n    \"name\": \"confidence\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default Confidence score to be set for the feeds, in case the feed record doesn't have a confidence score\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 50,\n    \"validation\": {\n       \"minlength\": 0,\n       \"maxlength\": 100\n    }\n  },\n  {\n    \"title\": \"Reputation\",\n    \"name\": \"reputation\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default Reputation to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Good\", \"Suspicious\", \"Malicious\", \"No Reputation Available\", \"TBD\"],\n    \"value\": \"Suspicious\"\n  },\n  {\n    \"title\": \"TLP\",\n    \"name\": \"tlp\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default TLP to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Red\", \"Amber\", \"Green\", \"White\"],\n    \"value\": \"White\"\n  },\n{\n    \"title\": \"Maximum Age (in days)\",\n    \"name\": \"expiry\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default age for the feeds. The indicator expires on 'valid_until' date unless a different expiry is specified here. If specified, the indicator will be marked expired on valid_from + expiry.\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 30\n  }\n  ]"
                }
              },
              "status": null,
              "top": "20",
              "left": "0",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "d29b8219-0763-4171-9d44-6a66d35d67fd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Take samples of all types",
              "description": "For mapping in the ingestion wizard, we need not have all the data. 5 samples of all types - ip, domain, url should be sufficient",
              "arguments": {
                "data": "{{ (vars.ipFeeds.feed | json_query('[:5]')) | union(vars.urlFeeds.feed | json_query('[:5]')) | union(vars.domainFeeds.feed | json_query('[:5]'))}}",
                "expiry": "{{vars.expiry}}",
                "confidence": "{{vars.confidence}}",
                "lastPullTime": "{{vars.fetchTime}}",
                "tlp_resolved": "{{vars.tlp_resolved}}",
                "lastPullTimeMacro": "{{vars.macroNameForLastPullTime}}",
                "reputation_resolved": "{{vars.reputation_resolved}}"
              },
              "status": null,
              "top": "240",
              "left": "1740",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "33daec82-c55c-4c1d-a066-eaafe2d50443"
            },
            {
              "@type": "WorkflowStep",
              "name": "Collect all data newer than last pull time",
              "description": null,
              "arguments": {
                "data": "{% set _new_feeds=[] %}\n{% set _temp=_new_feeds.extend(vars.ipFeeds.feed) %}\n{% set _temp=_new_feeds.extend(vars.urlFeeds.feed) %}\n{% set _temp=_new_feeds.extend(vars.domainFeeds.feed) %}\n{{ _new_feeds }}",
                "expiry": "{{vars.expiry}}",
                "confidence": "{{vars.confidence}}",
                "lastPullTime": "{{vars.fetchTime}}",
                "tlp_resolved": "{{vars.tlp_resolved}}",
                "lastPullTimeMacro": "{{vars.macroNameForLastPullTime}}",
                "reputation_resolved": "{{vars.reputation_resolved}}"
              },
              "status": null,
              "top": "500",
              "left": "1740",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "3bbf1071-795b-4e8e-a4a1-8f6d7214d6da"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch IPv4",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "when": "{{\"IP\" in vars.feedtypes}}",
                "config": "71786850-ce25-4493-afad-8817c441ced6",
                "params": {
                  "last_pull_time": "{{vars.lastPullTime}}"
                },
                "version": "2.0.1",
                "connector": "malsilo",
                "operation": "get_ipv4_feed",
                "operationTitle": "Get IPv4 Feeds",
                "pickFromTenant": false,
                "step_variables": {
                  "ipFeeds": "{{vars.result.data}}"
                }
              },
              "status": null,
              "top": "280",
              "left": "800",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "6949656e-b94a-4d0d-8757-cda74d044bae"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Domain",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "when": "{{\"Domain\" in vars.feedtypes}}",
                "config": "71786850-ce25-4493-afad-8817c441ced6",
                "params": {
                  "last_pull_time": "{{vars.lastPullTime}}"
                },
                "version": "2.0.1",
                "connector": "malsilo",
                "operation": "get_domain_feed",
                "operationTitle": "Get Domain Feeds",
                "pickFromTenant": false,
                "step_variables": {
                  "domainFeeds": "{{vars.result.data}}"
                }
              },
              "status": null,
              "top": "380",
              "left": "800",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "65496130-c9cc-42fb-a447-38598b8070e4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Do we need data only for mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, field mapping only",
                    "step_iri": "/api/3/workflow_steps/33daec82-c55c-4c1d-a066-eaafe2d50443",
                    "condition": "{{ 'env_setup' in vars.request and vars.request.env_setup }}",
                    "step_name": "Take samples of all types"
                  },
                  {
                    "option": "No, for ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/3bbf1071-795b-4e8e-a4a1-8f6d7214d6da",
                    "step_name": "Collect all data newer than last pull time"
                  }
                ]
              },
              "status": null,
              "top": "380",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "1539f637-e2b8-4aa2-8b94-bed35599d2da"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch URL",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "when": "{{\"URL\" in vars.feedtypes}}",
                "config": "71786850-ce25-4493-afad-8817c441ced6",
                "params": {
                  "last_pull_time": "{{vars.lastPullTime}}"
                },
                "version": "2.0.1",
                "connector": "malsilo",
                "operation": "get_url_feed",
                "operationTitle": "Get URL Feeds",
                "pickFromTenant": false,
                "step_variables": {
                  "urlFeeds": "{{vars.result.data}}"
                }
              },
              "status": null,
              "top": "480",
              "left": "800",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b59ed053-0017-4a09-b81b-30c637ee36d3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Collect Feeds Lists",
              "description": null,
              "arguments": {
                "ipFeeds": "{% if \"IP\" in vars.feedtypes %}{{vars.steps.Fetch_IPv4.data}}{% else %}{\"feed\": [], \"generatedAt\": 0}{% endif %}",
                "urlFeeds": "{% if \"URL\" in vars.feedtypes %}{{vars.steps.Fetch_URL.data}}{% else %}{\"feed\": [], \"generatedAt\": 0}{% endif %}",
                "domainFeeds": "{% if \"Domain\" in vars.feedtypes %}{{vars.steps.Fetch_Domain.data}}{% else %}{\"feed\": [], \"generatedAt\": 0}{% endif %}"
              },
              "status": null,
              "top": "380",
              "left": "1140",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "09b015f7-bebe-46f6-bb67-08ffeaa1d7fc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Resolve Range",
              "description": null,
              "arguments": {
                "tlp_resolved": "{{vars.tlp | resolveRange(vars.tlp_map)}}",
                "pullTimeMacroName": "MalSiloLastPullTime",
                "reputation_resolved": "{{vars.reputation | resolveRange(vars.reputation_map)}}"
              },
              "status": null,
              "top": "260",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "e84e7705-a110-4b83-8027-e966a29c7eb4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Last Pull Time",
              "description": null,
              "arguments": {
                "when": "{{vars.request.env_setup}}",
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": {
                  "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}0{% endif %}"
                }
              },
              "status": null,
              "top": "380",
              "left": "460",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "0c130a60-1d82-43b2-900c-c0ba3c00c716"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/bcced530-f04c-415f-a766-651c5e1f91ec",
              "sourceStep": "/api/3/workflow_steps/d29b8219-0763-4171-9d44-6a66d35d67fd",
              "label": null,
              "isExecuted": false,
              "uuid": "9f755ec5-fff6-4469-99ef-d861990aef44"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do we need data only for mapping -> Take samples of all types",
              "targetStep": "/api/3/workflow_steps/33daec82-c55c-4c1d-a066-eaafe2d50443",
              "sourceStep": "/api/3/workflow_steps/1539f637-e2b8-4aa2-8b94-bed35599d2da",
              "label": "Yes, field mapping only",
              "isExecuted": false,
              "uuid": "da967b90-e6db-4362-ba2d-154f7ef7b692"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch IPv4 -> Copy  of Configuration",
              "targetStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc",
              "sourceStep": "/api/3/workflow_steps/6949656e-b94a-4d0d-8757-cda74d044bae",
              "label": null,
              "isExecuted": false,
              "uuid": "eba083f6-e840-4aa8-b3ed-18a4f4955ef6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Domain -> Copy  of Configuration",
              "targetStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc",
              "sourceStep": "/api/3/workflow_steps/65496130-c9cc-42fb-a447-38598b8070e4",
              "label": null,
              "isExecuted": false,
              "uuid": "3c96cc59-ae7d-4554-8acc-1c087bda2161"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch URL -> Copy  of Configuration",
              "targetStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc",
              "sourceStep": "/api/3/workflow_steps/b59ed053-0017-4a09-b81b-30c637ee36d3",
              "label": null,
              "isExecuted": false,
              "uuid": "671b1ca3-bcd7-405c-a3f5-ee2ef4156a88"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Configuration -> Do we need data only for mapping",
              "targetStep": "/api/3/workflow_steps/1539f637-e2b8-4aa2-8b94-bed35599d2da",
              "sourceStep": "/api/3/workflow_steps/09b015f7-bebe-46f6-bb67-08ffeaa1d7fc",
              "label": null,
              "isExecuted": false,
              "uuid": "3c783260-1666-4f51-a9fe-d525ec294582"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Resolve Range",
              "targetStep": "/api/3/workflow_steps/e84e7705-a110-4b83-8027-e966a29c7eb4",
              "sourceStep": "/api/3/workflow_steps/bcced530-f04c-415f-a766-651c5e1f91ec",
              "label": null,
              "isExecuted": false,
              "uuid": "de3de96f-39a1-4b29-8900-1543e23d629b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Resolve Range -> update macro",
              "targetStep": "/api/3/workflow_steps/0c130a60-1d82-43b2-900c-c0ba3c00c716",
              "sourceStep": "/api/3/workflow_steps/e84e7705-a110-4b83-8027-e966a29c7eb4",
              "label": null,
              "isExecuted": false,
              "uuid": "4d33ca52-e50d-4d76-aa74-a451df4da7d7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "update macro -> Fetch Domain",
              "targetStep": "/api/3/workflow_steps/65496130-c9cc-42fb-a447-38598b8070e4",
              "sourceStep": "/api/3/workflow_steps/0c130a60-1d82-43b2-900c-c0ba3c00c716",
              "label": null,
              "isExecuted": false,
              "uuid": "1b64ce31-9c6a-495a-86b6-4f08ad3c7d04"
            },
            {
              "@type": "WorkflowRoute",
              "name": "update macro -> Fetch IPv4",
              "targetStep": "/api/3/workflow_steps/6949656e-b94a-4d0d-8757-cda74d044bae",
              "sourceStep": "/api/3/workflow_steps/0c130a60-1d82-43b2-900c-c0ba3c00c716",
              "label": null,
              "isExecuted": false,
              "uuid": "d5db29e2-97b6-40a2-89b6-2b241cb61988"
            },
            {
              "@type": "WorkflowRoute",
              "name": "update macro -> Fetch URL",
              "targetStep": "/api/3/workflow_steps/b59ed053-0017-4a09-b81b-30c637ee36d3",
              "sourceStep": "/api/3/workflow_steps/0c130a60-1d82-43b2-900c-c0ba3c00c716",
              "label": null,
              "isExecuted": false,
              "uuid": "2129c41c-32c0-472e-ac20-b2247e16fa35"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do we need data only for mapping -> Collect all data newer than last pull time",
              "targetStep": "/api/3/workflow_steps/3bbf1071-795b-4e8e-a4a1-8f6d7214d6da",
              "sourceStep": "/api/3/workflow_steps/1539f637-e2b8-4aa2-8b94-bed35599d2da",
              "label": "No, for ingestion",
              "isExecuted": false,
              "uuid": "8e413af9-4f19-4865-aca1-840a86c1caac"
            }
          ],
          "priority": null,
          "uuid": "9634df50-4ed5-45f0-a9ed-ad578a1e6a55",
          "id": 511,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1649740284.366363,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1649743312.209923,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "malsilo"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Domain Feeds",
          "aliasName": null,
          "tag": null,
          "description": "Get Domain Feeds from MalSilo",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1649227695,
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7e63f6ca-f03b-4843-ae0c-6dde01b3991d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d1a6e7aa-5759-431c-9f4e-63a6f9d71e46",
                "title": "Get MalSilo Domain Feeds",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "7e63f6ca-f03b-4843-ae0c-6dde01b3991d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Domain Feeds",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "config": "71786850-ce25-4493-afad-8817c441ced6",
                "params": {
                  "last_pull_time": "{% if globalVars.MalSiloLastPullTime %}{{ globalVars.MalSiloLastPullTime }}{% else %}{{ arrow.utcnow().timestamp }}{% endif %}"
                },
                "version": "2.0.1",
                "connector": "malsilo",
                "operation": "get_domain_feed",
                "operationTitle": "Get Domain Feeds",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "200",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9697d1de-e783-4069-a699-360439422071"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get IP Feeds",
              "targetStep": "/api/3/workflow_steps/9697d1de-e783-4069-a699-360439422071",
              "sourceStep": "/api/3/workflow_steps/7e63f6ca-f03b-4843-ae0c-6dde01b3991d",
              "label": null,
              "isExecuted": false,
              "uuid": "eeb90c17-95ba-471a-8ee2-9e2aad629a67"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "ba94256a-34ac-4b3e-8438-325656ee2443",
          "id": 512,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1649740284.366904,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1649740284.366904,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "malsilo"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> MalSilo > Create",
          "aliasName": null,
          "tag": "#malsilo #dataingestion #create",
          "description": "Data Ingestion Playbook",
          "isActive": false,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "threat_feeds",
            "confidence",
            "tlp_resolved",
            "reputation_resolved",
            "expiry",
            "lastPullTime"
          ],
          "synchronous": false,
          "lastModifyDate": 1649740905,
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b68bd691-7ecf-4507-9f54-8c993e7a4581",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "b68bd691-7ecf-4507-9f54-8c993e7a4581"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "indicators_reputation_map": "{}",
                "indicators_indicatorStatus_map": "{}",
                "indicators_typeofindicator_map": "{'domain': {{'ThreatIntelFeedType'| picklist('Domain') }}, 'ipv4': {{'ThreatIntelFeedType'| picklist('IP Address') }}, 'url': {{'ThreatIntelFeedType'| picklist('URL') }}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "252bacab-2487-4dfd-9af0-8d7b29862e93"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params['threat_feeds']}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "tLP": "{{vars.input.params['tlp_resolved']}}",
                  "value": "{{ vars.item['value'] }}",
                  "source": "MalSilo",
                  "created": "{{vars.input.params.lastPullTime}}",
                  "lastSeen": "{{ arrow.get(vars.item.Lastseen, 'YYYY-MM-DD').int_timestamp }}",
                  "__replace": "",
                  "expiresOn": "{{arrow.get(vars.item.Lastseen).shift(years=0, months=0, weeks=0, days=vars.input.params.expiry, hours=0, minutes=0, seconds=0).int_timestamp}}",
                  "validFrom": "{{ arrow.get(vars.item.Firstseen, 'YYYY-MM-DD').int_timestamp }}",
                  "confidence": "{% if vars.input.params['confidence'] %}{{ vars.input.params['confidence'] }}{% else %}0{% endif %}",
                  "recordTags": "{% set _tags=[] %}{% set _temp=[] %}{% for my_item in vars.item[\"tags\"].split(\",\") %}{% if my_item | length > 2 %}{% set _temp=_tags.append(my_item) %}{% endif %}{% endfor %}{{_tags}}",
                  "reputation": "{{vars.input.params['reputation_resolved']}}",
                  "typeOfFeed": "{{vars.item[\"type\"] | resolveRange(vars.indicators_typeofindicator_map)}}",
                  "description": "<p>Threat: {{vars.item.threat}}<br>Tags: {{vars.item.tags}}<br>Value: &nbsp;{{vars.item[\"value\"] }}</p>"
                },
                "_showJson": false,
                "collection": "/api/ingest-feeds/threat_intel_feeds",
                "__recommend": [],
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/7b221880-716b-4726-a2ca-5e568d330b3e",
              "uuid": "f2ad87e6-7d03-446d-82a1-384a4d289301"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/252bacab-2487-4dfd-9af0-8d7b29862e93",
              "sourceStep": "/api/3/workflow_steps/b68bd691-7ecf-4507-9f54-8c993e7a4581",
              "label": null,
              "isExecuted": false,
              "uuid": "616c8708-0557-4a68-a194-0510bb6564a6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create Record",
              "targetStep": "/api/3/workflow_steps/f2ad87e6-7d03-446d-82a1-384a4d289301",
              "sourceStep": "/api/3/workflow_steps/252bacab-2487-4dfd-9af0-8d7b29862e93",
              "label": null,
              "isExecuted": false,
              "uuid": "77dfd132-a08e-4612-9c51-e1eedc932012"
            }
          ],
          "priority": null,
          "uuid": "ef459fff-30b0-4de5-936a-21337b312e68",
          "id": 513,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1649740284.367248,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1649740905.140443,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "malsilo"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get URL Feeds",
          "aliasName": null,
          "tag": null,
          "description": "Get URL Feeds from MalSilo",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1649163159,
          "collection": "/api/3/workflow_collections/dfd1ec27-4dfc-4eeb-9810-f3a3f21d86b1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1959341e-86e1-4d6a-be2f-608bed7c5997",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "37170180-a7dc-4f44-9c9a-96aa85b6a5ac",
                "title": "Get MalSilo URL Feeds",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "1959341e-86e1-4d6a-be2f-608bed7c5997"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get URL Feeds",
              "description": null,
              "arguments": {
                "name": "MalSilo",
                "config": "71786850-ce25-4493-afad-8817c441ced6",
                "params": {
                  "last_pull_time": "{% if globalVars.MalSiloLastPullTime %}{{ globalVars.MalSiloLastPullTime }}{% else %}{{ arrow.utcnow().timestamp }}{% endif %}"
                },
                "version": "2.0.1",
                "connector": "malsilo",
                "operation": "get_url_feed",
                "operationTitle": "Get URL Feeds",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "200",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "8ab7a8c3-7dd1-45d0-bd67-d1ec6257038d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get IP Feeds",
              "targetStep": "/api/3/workflow_steps/8ab7a8c3-7dd1-45d0-bd67-d1ec6257038d",
              "sourceStep": "/api/3/workflow_steps/1959341e-86e1-4d6a-be2f-608bed7c5997",
              "label": null,
              "isExecuted": false,
              "uuid": "24486673-8744-41bd-ae92-53f96f767e73"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "f47c94de-e2fa-4347-b857-1a25a961b5b7",
          "id": 514,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1649740284.367576,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1649740284.367576,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "malsilo"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "malsilo",
    "dataingestion",
    "ingest",
    "fetch",
    "create"
  ]
}
