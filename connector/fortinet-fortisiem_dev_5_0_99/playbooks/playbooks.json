{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Fortinet FortiSIEM - 5.0.3",
      "description": "Sample playbooks for \"Fortinet FortiSIEM\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": null,
      "uuid": "cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
      "id": 337,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "dataingestion",
        "fortinet-fortisiem"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Device: Get All Devices For Specified IP Address Range",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves a short description for devices that are configured on the Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a6ea7096-69b6-4284-b546-c848d1123aa4",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "533ac3c6-b710-4a39-9e8c-0fd05ad6f0c4",
                "title": "Fortinet FortiSIEM: Get All Devices For Specified IP Address Range",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a6ea7096-69b6-4284-b546-c848d1123aa4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get All Devices For Specified IP Address Range",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "org": "",
                  "excludeIps": "",
                  "includeIps": "170.106.76.105"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_devices_details_in_address",
                "operationTitle": "Get All Devices For Specified Address Range",
                "step_variables": []
              },
              "status": null,
              "top": "130",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "df60a699-e808-4e16-977e-bde3a5b3b826"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get All Devices",
              "targetStep": "/api/3/workflow_steps/df60a699-e808-4e16-977e-bde3a5b3b826",
              "sourceStep": "/api/3/workflow_steps/a6ea7096-69b6-4284-b546-c848d1123aa4",
              "label": null,
              "isExecuted": false,
              "uuid": "6d3fc8a3-0bec-4b62-a92a-5ab45fe4c4e6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "04bd503f-e9aa-4383-9d6b-1812d32cfcfb",
          "id": 4435,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Import Lookup Table Data",
          "aliasName": null,
          "tag": null,
          "description": "This action allows importing the data of lookupTable based on input parameters you have provided",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/021522b4-74d7-4d6b-a529-036d4dfe7020",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ddcf77a2-2fda-429a-be72-51472f2c1dc5",
                "title": "Fortinet fortiSIEM: Import Lookup Table Data",
                "resources": [
                  "attachments"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "021522b4-74d7-4d6b-a529-036d4dfe7020"
            },
            {
              "@type": "WorkflowStep",
              "name": "Import Lookup Table Data",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "c2c9133a-8e6f-4f58-b765-8edefa9edafb",
                "params": {
                  "file": "{{vars.input.records[0]['@id']}}",
                  "input": "Attachment ID",
                  "mapping": "{\n  \"url\": 2,\n  \"score\": 1\n}",
                  "skipHeader": false,
                  "updateType": "Append",
                  "fileQuoteChar": "",
                  "fileSeparator": "",
                  "lookupTableId": "31972505564"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "import_lookup_table_data",
                "operationTitle": "Import Lookup Table Data",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "59f7a109-fc7f-42ae-aefd-ec503593b165"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Import Lookup Table Data",
              "targetStep": "/api/3/workflow_steps/59f7a109-fc7f-42ae-aefd-ec503593b165",
              "sourceStep": "/api/3/workflow_steps/021522b4-74d7-4d6b-a529-036d4dfe7020",
              "label": null,
              "isExecuted": false,
              "uuid": "72dd283b-83a8-42bf-b6ec-959f207a4e30"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "0dced261-a978-4868-aa75-68fc99654559",
          "id": 4409,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Get All Lookup Table",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves the list of lookupTable definitions",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/28640f33-29d5-4cd9-8dd7-8b0c304a05cd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "aaa7e914-0657-425a-b6b4-36757abcc212",
                "title": "Fortinet FortiSIEM: Get All Lookup Table",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "28640f33-29d5-4cd9-8dd7-8b0c304a05cd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get All Lookup Table",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "c2c9133a-8e6f-4f58-b765-8edefa9edafb",
                "params": {
                  "size": 25,
                  "stat": 0
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_all_lookup_tables",
                "operationTitle": "Get All Lookup Table",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "169",
              "left": "340",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f63b589c-a036-4cde-a184-ea52aa093f59"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Lookup Table",
              "targetStep": "/api/3/workflow_steps/f63b589c-a036-4cde-a184-ea52aa093f59",
              "sourceStep": "/api/3/workflow_steps/28640f33-29d5-4cd9-8dd7-8b0c304a05cd",
              "label": null,
              "isExecuted": false,
              "uuid": "f361e9f1-d286-47c1-9984-f05dcdc4fefb"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "159cfac5-7691-49d9-8b28-fd59fdd99f7e",
          "id": 4418,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> FortiSIEM > Fetch",
          "aliasName": null,
          "tag": "#fortinet-fortisiem #fetch #dataingestion",
          "description": "This playbook fetch the open incidents.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b523d3e0-7124-4894-bd9d-c9eb3e9f24e0",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Check Fetch Mode",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/0c705977-987c-4cd4-839a-1e829acebc1b",
                    "condition": "{{ vars.fetch_mode == 'By Updates In Last X Minutes' }}",
                    "step_name": "Get Tenant IDs"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/65e7b578-8690-451b-aaa0-237640b6944d",
                    "condition": "{{ vars.fetch_mode == 'By Sample Incident ID' }}",
                    "step_name": "Fetch Incident By ID"
                  }
                ]
              },
              "status": null,
              "top": "420",
              "left": "760",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "0082cfe8-fe5c-4c78-b4c4-ddea6577b720"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Tenant IDs",
              "description": null,
              "arguments": {
                "when": "{{vars.is_mssp == True}}",
                "params": {
                  "iri": "/api/3/tenants",
                  "body": "{}",
                  "method": "GET"
                },
                "version": "3.0.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "ignore_errors": true,
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": {
                  "mapped_ids": "{% set final_dict = {} %} \n{% for k,v in vars.tenant_mapping.items() %}\n{% for dict in vars.result.data['hydra:member'] %}\n{% if dict.name==v%}\n{% set test= final_dict.update({k:dict[\"@id\"]}) %}\n{% endif %}\n{% endfor %}\n{% endfor %}\n{{final_dict}}",
                  "tenant_ids_info": "{{vars.result.data['hydra:member']}}"
                }
              },
              "status": null,
              "top": "540",
              "left": "760",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "0c705977-987c-4cd4-839a-1e829acebc1b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "macro_name": "{{vars.FortiSIEMMacroName}}",
                "curr_timestamp": "{{ arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss.ssss')\n}}Z",
                "last_pull_time": "{%if vars.steps.Get_Macro_Value.data['hydra:member'] | length > 0 %}{%if vars.request.env_setup %}{%if not vars.minutes or vars.minutes == ''%}0{% else %}{{((arrow.utcnow().shift(minutes=-vars.minutes)).format('YYYY-MM-DDTHH:mm:ss.ssss'))}}Z{% endif %}{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}{% else %}{%if not vars.minutes or vars.minutes == ''%}0{% else %}{{((arrow.utcnow().shift(minutes=-vars.minutes)).format('YYYY-MM-DDTHH:mm:ss.ssss'))}}Z{% endif %}{% endif %}"
              },
              "status": null,
              "top": "320",
              "left": "580",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "1903b2ad-8661-4782-aacf-efba24f740aa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.FortiSIEMMacroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "4a5b6f65-26a5-49ec-ae54-069e3abd36ef"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Incident By ID",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "cf97ef5d-fedf-4ffe-ad3b-27354b3c1fed",
                "params": {
                  "to": "{{vars.to}}",
                  "from": "{{vars.from}}",
                  "incidentId": "{{vars.incidentId}}",
                  "select_clause": "",
                  "time_selection": "Absolute Time"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_incident_details",
                "operationTitle": "Get Incident Details",
                "pickFromTenant": false,
                "step_variables": {
                  "fetched_events": "{{vars.result.data.data}}"
                }
              },
              "status": null,
              "top": "420",
              "left": "1100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "65e7b578-8690-451b-aaa0-237640b6944d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "search": "{\"status\": [0]}",
                "is_mssp": false,
                "minutes": "10",
                "fetch_mode": "By Updates In Last X Minutes",
                "event_count": 5,
                "incidentStatus": [
                  "Active"
                ],
                "incident_count": "500",
                "filter_incidents": [
                  "Incident Status"
                ],
                "FortiSIEMMacroName": "FortiSIEMLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "120",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "77c645a2-cd3f-4e5f-af7f-0b456e526c2d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Save Result",
              "description": null,
              "arguments": {
                "data": "{{vars.fetched_events}}",
                "event_count": "{{vars.event_count}}",
                "current_time": "{{vars.curr_timestamp}}",
                "tenant_mapping": "{{vars.mapped_ids | default({})}}",
                "FortiSIEMMacroName": "{{vars.FortiSIEMMacroName}}",
                "link_mitre_technique": "{{vars.link_mitre_technique}}"
              },
              "status": null,
              "top": "480",
              "left": "1540",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "b28d6cc9-3d6e-4a7d-9058-179c70848ed9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\":\"Fetch Mode\",\n    \"required\":true,\n    \"editable\":true,\n    \"visible\":true,\n    \"type\":\"select\",\n    \"name\":\"fetch_mode\",\n    \"options\":[\n      \"By Updates In Last X Minutes\",\n      \"By Sample Incident ID\"\n    ],\n    \"onchange\":{\n      \"By Sample Incident ID\":[\n        {\n          \"title\":\"Incident ID\",\n          \"name\":\"incidentId\",\n          \"type\":\"text\",\n          \"required\":true,\n          \"editable\":true,\n          \"visible\":true,\n          \"tooltip\":\"Incident ID you would like to use for mapping\"\n        }\n      ],\n      \"By Updates In Last X Minutes\":[\n        {\n          \"title\":\"Pull Incidents Created/Updated In Last X Minutes\",\n          \"required\":true,\n          \"editable\":true,\n          \"visible\":true,\n          \"type\":\"text\",\n          \"name\":\"minutes\",\n          \"tooltip\":\"Fetch incidents from last X minutes. e.g 5\",\n          \"value\":5\n        },\n        {\n          \"title\":\"Maximum Incidents To Pull\",\n          \"name\":\"incident_count\",\n          \"type\":\"integer\",\n          \"required\":false,\n          \"editable\":true,\n          \"visible\":true,\n          \"value\":1000,\n          \"tooltip\":\"The Maximum number of Incidents to be fetched from FortiSIEM\"\n        },\n        {\n          \"title\":\"Maximum Events To Pull Per Incident\",\n          \"name\":\"event_count\",\n          \"type\":\"integer\",\n          \"required\":false,\n          \"editable\":true,\n          \"visible\":true,\n          \"value\":5,\n          \"tooltip\":\"The Maximum number of events to be fetched per incident \"\n        },\n        {\n          \"title\":\"Incident Status\",\n          \"type\":\"multiselect\",\n          \"name\":\"incidentStatus\",\n          \"options\":[\n            \"Active\",\n            \"Manually Cleared\",\n            \"System Cleared\",\n            \"Auto Cleared\"\n          ],\n          \"required\":false,\n          \"editable\":true,\n          \"visible\":true,\n          \"value\":[\n            \"Active\"\n          ]\n        },\n        {\n          \"title\":\"Incident Category\",\n          \"type\":\"text\",\n          \"name\":\"incidentCategory\",\n          \"tooltip\":\"Retrieve the incidents records for specified incident category\",\n          \"required\":false,\n          \"editable\":true,\n          \"visible\":true,\n          \"placeholder\":[\n            1,\n            3\n          ]\n        },\n        {\n          \"title\":\"Event Type\",\n          \"type\":\"text\",\n          \"name\":\"eventType\",\n          \"tooltip\":\"Retrieve the incidents records for specified event type\",\n          \"required\":false,\n          \"editable\":true,\n          \"visible\":true,\n          \"placeholder\":[\n            \"PH_RULE_SYS_USER_CREATED\",\n            \"PH_RULE_ACCOUNT_LOCKOUT_SYSTEM\"\n          ]\n        },\n        {\n          \"title\":\"Other Filters\",\n          \"tooltip\":\"Enter parameters based on which you want to filter the response. e.g. {\\\"status\\\": [0], \\\"eventType\\\": [\\\"PH_RULE_SERVER_CPU_WARN\\\"], \\\"incidentRptIp\\\": [\\\"10.7.12.156\\\"]}\",\n          \"type\":\"json\",\n          \"name\":\"search\",\n          \"required\":false,\n          \"editable\":true,\n          \"visible\":true,\n          \"value\":\"{\\\"incidentRptIp\\\": [\\\"10.7.12.156\\\"]}\"\n        },\n        {\n          \"title\":\"Configure Multi-Tenant Mappings\",\n          \"name\":\"is_mssp\",\n          \"type\":\"checkbox\",\n          \"required\":false,\n          \"editable\":true,\n          \"visible\":true,\n          \"value\":false,\n          \"onchange\":{\n            \"true\":[\n              {\n                \"title\":\"Organization Mapping\",\n                \"name\":\"tenant_mapping\",\n                \"required\":true,\n                \"visible\":true,\n                \"editable\":true,\n                \"type\":\"json\",\n                \"value\":\"{\\\"Super\\\": \\\"Self\\\",\\\"fortisiem_customer1\\\": \\\"fortisoar_customer1\\\"}\",\n                \"tooltip\":\"Map the organization in FortiSIEM with the tenant in FortiSOAR. This tenant mapping will ensure that the incidents are mapped to the right tenant in FortiSOAR during ingestion.\"\n              }\n            ]\n          }\n        }\n      ]\n    },\n    \"tooltip\":\"Allows to pull latest incidents or sample incidents for field mapping.\",\n    \"value\":\"By Updates in Last X Minutes\"\n  }\n]"
                }
              },
              "status": null,
              "top": "20",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "b523d3e0-7124-4894-bd9d-c9eb3e9f24e0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Incidents",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "cf97ef5d-fedf-4ffe-ad3b-27354b3c1fed",
                "params": {
                  "ip": "{{vars.ip}}",
                  "to": "{{vars.curr_timestamp}}",
                  "org": "{{vars.org}}",
                  "from": "{{vars.last_pull_time}}",
                  "size": "{{vars.incident_count}}",
                  "start": 0,
                  "fields": "",
                  "search": "{{vars.search}}",
                  "status": "{{vars.status}}",
                  "timeTo": "{{vars.curr_timestamp}}",
                  "orderBy": "",
                  "perPage": 100,
                  "hostname": "{{vars.hostname}}",
                  "severity": "{{vars.severity}}",
                  "timeFrom": "{{vars.last_pull_time}}",
                  "eventType": "{{vars.eventType}}",
                  "search_by": "By Other Filters",
                  "incidentId": "",
                  "select_clause": "",
                  "incidentStatus": "{{vars.incidentStatus}}",
                  "time_selection": "Absolute Time",
                  "reportingDevice": "{{vars.reportingDevice}}",
                  "incidentCategory": "{{vars.incidentCategory}}",
                  "incidentSubCategory": "{{vars.incidentSubCategory}}"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_incidents",
                "operationTitle": "List Incidents",
                "step_variables": {
                  "fetched_events": "{{vars.result.data.data}}"
                }
              },
              "status": null,
              "top": "540",
              "left": "1100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "c4bb5aa7-f8ad-4482-bec3-53da8500451a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/1903b2ad-8661-4782-aacf-efba24f740aa",
              "sourceStep": "/api/3/workflow_steps/4a5b6f65-26a5-49ec-ae54-069e3abd36ef",
              "label": null,
              "isExecuted": false,
              "uuid": "eade827e-a473-404c-8cc5-1cb4c2204999"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Fetch Mode -> Get Tenant IDs",
              "targetStep": "/api/3/workflow_steps/0c705977-987c-4cd4-839a-1e829acebc1b",
              "sourceStep": "/api/3/workflow_steps/0082cfe8-fe5c-4c78-b4c4-ddea6577b720",
              "label": null,
              "isExecuted": false,
              "uuid": "ccdc3c4b-e6c2-48a1-9fc9-e8657525ee7f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Check Fetch Mode",
              "targetStep": "/api/3/workflow_steps/0082cfe8-fe5c-4c78-b4c4-ddea6577b720",
              "sourceStep": "/api/3/workflow_steps/1903b2ad-8661-4782-aacf-efba24f740aa",
              "label": null,
              "isExecuted": false,
              "uuid": "7156f622-734c-4a67-98ef-24c98ebd6469"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Incidents -> Save Result",
              "targetStep": "/api/3/workflow_steps/b28d6cc9-3d6e-4a7d-9058-179c70848ed9",
              "sourceStep": "/api/3/workflow_steps/c4bb5aa7-f8ad-4482-bec3-53da8500451a",
              "label": null,
              "isExecuted": false,
              "uuid": "7d60739f-f8d6-478a-99c7-c7d83c12284c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Tenant IDs -> Fetch Incidents",
              "targetStep": "/api/3/workflow_steps/c4bb5aa7-f8ad-4482-bec3-53da8500451a",
              "sourceStep": "/api/3/workflow_steps/0c705977-987c-4cd4-839a-1e829acebc1b",
              "label": null,
              "isExecuted": false,
              "uuid": "94bc61de-9eb7-455d-9abe-38ce2883e207"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/4a5b6f65-26a5-49ec-ae54-069e3abd36ef",
              "sourceStep": "/api/3/workflow_steps/77c645a2-cd3f-4e5f-af7f-0b456e526c2d",
              "label": null,
              "isExecuted": false,
              "uuid": "7a694074-a98a-4527-a88c-d26798c4880c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Incident By ID 2 -> Save Result",
              "targetStep": "/api/3/workflow_steps/b28d6cc9-3d6e-4a7d-9058-179c70848ed9",
              "sourceStep": "/api/3/workflow_steps/65e7b578-8690-451b-aaa0-237640b6944d",
              "label": null,
              "isExecuted": false,
              "uuid": "1496c961-c192-4b0d-a166-893c0b9f15b7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/77c645a2-cd3f-4e5f-af7f-0b456e526c2d",
              "sourceStep": "/api/3/workflow_steps/b523d3e0-7124-4894-bd9d-c9eb3e9f24e0",
              "label": null,
              "isExecuted": false,
              "uuid": "917b8d42-b655-442e-bd9e-9c524c9597da"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Fetch Mode -> Fetch Incident By ID 2",
              "targetStep": "/api/3/workflow_steps/65e7b578-8690-451b-aaa0-237640b6944d",
              "sourceStep": "/api/3/workflow_steps/0082cfe8-fe5c-4c78-b4c4-ddea6577b720",
              "label": null,
              "isExecuted": false,
              "uuid": "ae9b825f-e974-45f0-a01c-3cfff882eb73"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "1dd26258-863e-44cd-b184-f9ccd92300ec",
          "id": 4421,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Get Lookup Table Data",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves items of lookupTable based on input parameters provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/3f7033b4-b49c-4033-ae8d-af3032fc3f1a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "005115aa-79c5-4c0c-9cd1-c02847eeed07",
                "title": "Fortinet FortiSIEM: Get Lookup Table Data",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "3f7033b4-b49c-4033-ae8d-af3032fc3f1a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Lookup Table Data",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "9f0e938f-b12c-4093-b068-3824a66dd064",
                "params": {
                  "size": 25,
                  "start": 0,
                  "sortBy": "",
                  "searchText": "",
                  "lookupTableId": "31972505564"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_lookup_table_data",
                "operationTitle": "Get Lookup Table Data",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "143",
              "left": "387",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "44cb83d8-5e7d-4063-a4d5-b849ed79d9dd"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Lookup Table Data",
              "targetStep": "/api/3/workflow_steps/44cb83d8-5e7d-4063-a4d5-b849ed79d9dd",
              "sourceStep": "/api/3/workflow_steps/3f7033b4-b49c-4033-ae8d-af3032fc3f1a",
              "label": null,
              "isExecuted": false,
              "uuid": "0558272c-a73b-48ff-86bc-71f0581aa623"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "1e0fbd7f-774f-47a4-aaab-8a6ebc41b914",
          "id": 4407,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Update Watch List Entry",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "This action allows user to update any watch list entry. The JSON object of watch list entry must contain valid watch list entry id otherwise it will be saved as a new entry to ungrouped watch list.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/954ce187-5b19-4b46-b636-1eda1d863c93",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "0287b8c8-8bf3-4e9e-98fe-b97a11d52d6c",
                "title": "Fortinet FortiSIEM: Update Watch List Entry",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "954ce187-5b19-4b46-b636-1eda1d863c93"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Watch List Entry",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "bab68daa-355c-47df-bae1-2c8869f2a163",
                "params": {
                  "count": 10,
                  "state": true,
                  "lastSeenTime": "1634796766000",
                  "other_params": "{\n  \"description\": \"sample added\",\n  \"ageOut\": \"1d\"\n}",
                  "watch_list_entry_id": "500604"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "update_watch_list_entry",
                "operationTitle": "Update Watch List Entry",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "9c571cd8-e0a7-4f44-b711-be07b7ccef1f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Watch List Entry",
              "targetStep": "/api/3/workflow_steps/9c571cd8-e0a7-4f44-b711-be07b7ccef1f",
              "sourceStep": "/api/3/workflow_steps/954ce187-5b19-4b46-b636-1eda1d863c93",
              "label": null,
              "isExecuted": false,
              "uuid": "ed74436f-bc96-482e-8c06-91078c93f7ef"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "201d986a-1717-4789-8462-03a18794386c",
          "id": 4425,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Create Watch List",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Creates a watch list in the FortiSIEM database. A watch list can contain one or more watch list entries",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1419f678-29a5-4843-b28c-2c6296395aea",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "db5217e6-32b1-4f95-a340-0c61c3841396",
                "title": "Watch List: Create Watch List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "1419f678-29a5-4843-b28c-2c6296395aea"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Watch List",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "bab68daa-355c-47df-bae1-2c8869f2a163",
                "params": {
                  "json_object": "{\n  \"description\": \"Servers, network or storage devices\",\n  \"displayName\": \"Resource Issues Test5\",\n  \"type\": \"DyWatchList\",\n  \"dataCreationType\": \"USER\",\n  \"valueType\": \"STRING\",\n  \"ageOut\": \"1d\",\n  \"custId\": 1,\n  \"entries\": [\n    {\n      \"inclusive\": true,\n      \"entryValue\": \"PVVol_A001_A000356_5neqww\",\n      \"ageOut\": \"1d\",\n      \"triggeringRules\": \"Datastore Space Warning\",\n      \"dataCreationType\": \"USER\"\n    }\n  ]\n}"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "create_watchlist_group",
                "operationTitle": "Save Watch List Groups With Watch List Entry",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "86f59d04-7dbb-4d3f-8d26-cb5d9a73bcaf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Create Watch List Group",
              "targetStep": "/api/3/workflow_steps/86f59d04-7dbb-4d3f-8d26-cb5d9a73bcaf",
              "sourceStep": "/api/3/workflow_steps/1419f678-29a5-4843-b28c-2c6296395aea",
              "label": null,
              "isExecuted": false,
              "uuid": "edc80c80-1d67-4999-ab87-bd8c4b27e2b3"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "226312ef-080f-4950-ba43-3f422e27f185",
          "id": 4429,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> FortiSIEM > Fetch Associated events for Incident",
          "aliasName": null,
          "tag": "#fortinet-fortisiem #dataingestion",
          "description": "Fetch Associated events for Incident.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "incidentdata",
            "max_events"
          ],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/96e574bc-0812-463c-ae8e-23f7f6ecf0b0",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "max_events": "{{ vars.max_events }}",
                      "incidentdata": "{{ vars.incidentdata }}",
                      "link_mitre_technique": "{{ vars.link_mitre_technique }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "96e574bc-0812-463c-ae8e-23f7f6ecf0b0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "resource": {
                  "sourcedata": "{{vars.incident_details | toJSON }}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.incidentdata['@id']}}",
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "9a78c1ec-052d-4d62-b1c8-d6f749476c31"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "incident_details": "{\"incident_data\":  {{vars.input.params.incidentdata.sourcedata | toDict}}, \"associated_events\": {{vars.fetch_event}} }"
              },
              "status": null,
              "top": "291",
              "left": "412",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "9dc7c688-7528-4602-8d06-b8ac47cbbe0d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Events for Incident",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "cf97ef5d-fedf-4ffe-ad3b-27354b3c1fed",
                "params": {
                  "to": "",
                  "from": "",
                  "start": 0,
                  "allData": true,
                  "perPage": "{{vars.input.params['max_events'] | int}}",
                  "incident_id": "{{vars.input.params.incidentdata.sourceId}}"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_associated_events",
                "operationTitle": "Get Events For Incident",
                "step_variables": {
                  "fetch_event": "{{vars.steps.Fetch_Events_for_Incident.data}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e1acb3b7-418f-4926-bb62-b0ef827fb708"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Events for Incident -> Set Result",
              "targetStep": "/api/3/workflow_steps/9dc7c688-7528-4602-8d06-b8ac47cbbe0d",
              "sourceStep": "/api/3/workflow_steps/e1acb3b7-418f-4926-bb62-b0ef827fb708",
              "label": null,
              "isExecuted": false,
              "uuid": "b8c15c3b-0216-4f32-933c-ff633ee2df4e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Events for Incident",
              "targetStep": "/api/3/workflow_steps/e1acb3b7-418f-4926-bb62-b0ef827fb708",
              "sourceStep": "/api/3/workflow_steps/96e574bc-0812-463c-ae8e-23f7f6ecf0b0",
              "label": null,
              "isExecuted": false,
              "uuid": "d7a10bc1-ac76-40d9-a51d-088baa1c3307"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Result -> Update Alert",
              "targetStep": "/api/3/workflow_steps/9a78c1ec-052d-4d62-b1c8-d6f749476c31",
              "sourceStep": "/api/3/workflow_steps/9dc7c688-7528-4602-8d06-b8ac47cbbe0d",
              "label": null,
              "isExecuted": false,
              "uuid": "6498f3be-f32a-44c0-b0d6-fe06a5b70d14"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "2f83ebaf-5df3-420e-a4f0-41f3f2f04384",
          "id": 4414,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Incident: Update Incident",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Update attributes of specific incident on the Fortinet FortiSIEM server based on inputs you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7ed557ce-af16-42c0-9b91-c683bd40051d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "c635797d-d238-4009-a728-5c40ec96183f",
                "title": "Fortinet FortiSIEM:  Update Incident",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7ed557ce-af16-42c0-9b91-c683bd40051d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Incident",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "comments": "updating incident",
                  "severity": "MEDIUM",
                  "incidentId": "487268",
                  "resolution": "",
                  "incidentStatus": "Active",
                  "externalTicketId": "",
                  "externalTicketType": "Low",
                  "externalTicketState": "Assigned",
                  "externalAssignedUser": ""
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "update_incident",
                "operationTitle": "Update Incident",
                "step_variables": []
              },
              "status": null,
              "top": "190",
              "left": "248",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "ba627d08-845f-4f23-99ca-a327a43e5856"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Incident",
              "targetStep": "/api/3/workflow_steps/ba627d08-845f-4f23-99ca-a327a43e5856",
              "sourceStep": "/api/3/workflow_steps/7ed557ce-af16-42c0-9b91-c683bd40051d",
              "label": null,
              "isExecuted": false,
              "uuid": "0ee42278-7552-4b7c-90e4-576c47355db4"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3ae2b5a5-671e-4591-8f23-62bc880308e9",
          "id": 4439,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Incident: List Incidents",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves a list and details of incidents from the Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/163b7bd0-eaff-43d2-a73f-3fd6c33759e6",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "d8205d5c-6329-4c0b-a9ea-31236e7ca51f",
                "title": "Fortinet FortiSIEM: List Incidents",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "163b7bd0-eaff-43d2-a73f-3fd6c33759e6"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Incidents",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "size": "",
                  "start": 0,
                  "value": 2,
                  "fields": "",
                  "search": "",
                  "status": [
                    "Active"
                  ],
                  "timeTo": "2022-10-31T07:18:17.265Z",
                  "orderBy": "",
                  "perPage": 50,
                  "rel_time": "Hours",
                  "severity": [
                    "High"
                  ],
                  "timeFrom": "2022-10-29T18:30:00.000Z",
                  "eventType": "",
                  "search_by": "By Other Filters",
                  "incidentId": "",
                  "select_clause": "",
                  "incidentStatus": [],
                  "time_selection": "Relative Time",
                  "incidentCategory": "['1']",
                  "incidentSubCategory": ""
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_incidents",
                "operationTitle": "List Incidents",
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6ec070de-a84c-47d1-86b9-55ac13a59bf7"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> List Incidents",
              "targetStep": "/api/3/workflow_steps/6ec070de-a84c-47d1-86b9-55ac13a59bf7",
              "sourceStep": "/api/3/workflow_steps/163b7bd0-eaff-43d2-a73f-3fd6c33759e6",
              "label": null,
              "isExecuted": false,
              "uuid": "dab6bf51-8aa5-448b-a603-59698ae0a7a7"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3cc6deeb-e950-4bf9-80e1-e5b221ac5c5b",
          "id": 4417,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Resource List: Get Resource List Entries",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves list of all elements in a resource list from Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/87e77ca5-a61a-4e55-bed1-a54fcc46a67c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "8c998ef5-2165-4b19-9d6b-d042e5cfd2a9",
                "title": "Fortinet FortiSIEM: Get Resource List Entries",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "87e77ca5-a61a-4e55-bed1-a54fcc46a67c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Resource List Entries",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "76947ca6-2db4-4e66-891d-d104eb706517",
                "params": {
                  "limit": 100,
                  "start": 0,
                  "resource_id": "34110924",
                  "resource_type": "Malware Urls"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_resource_list_entries",
                "operationTitle": "Get Resource List Entries",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "d701b000-9b86-45e7-832c-2ba6498d48e4"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Resource List Entries",
              "targetStep": "/api/3/workflow_steps/d701b000-9b86-45e7-832c-2ba6498d48e4",
              "sourceStep": "/api/3/workflow_steps/87e77ca5-a61a-4e55-bed1-a54fcc46a67c",
              "label": null,
              "isExecuted": false,
              "uuid": "e0be7f32-dab9-4a3b-b662-3932873723cd"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "40a2958d-5c87-4264-be5f-7556a2c89563",
          "id": 4437,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Get Watch Lists",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieve details of watch lists based on input parameters you have provided",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/11968d47-81b0-48b3-b5b2-418f8ed2d17b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "190b6c78-7053-45bb-bbb3-8d5e44c53147",
                "title": "Fortinet FortiSIEM: Get Watch Lists",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "11968d47-81b0-48b3-b5b2-418f8ed2d17b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Watch Lists",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "bab68daa-355c-47df-bae1-2c8869f2a163",
                "params": {
                  "entryValue": "intranet.fortilabs.org",
                  "get_watch_list_by": "Get All Watch Lists"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_watch_lists",
                "operationTitle": "Get Watch Lists",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "260",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "448d8ac0-1554-4182-aff1-37fa9a4d70b5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Watch Lists",
              "targetStep": "/api/3/workflow_steps/448d8ac0-1554-4182-aff1-37fa9a4d70b5",
              "sourceStep": "/api/3/workflow_steps/11968d47-81b0-48b3-b5b2-418f8ed2d17b",
              "label": null,
              "isExecuted": false,
              "uuid": "5df3b2b6-7673-444a-93c0-51d6e8d51268"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "41c09fc5-a47e-4b1d-a493-852afef2a448",
          "id": 4433,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Check Import Task Status",
          "aliasName": null,
          "tag": null,
          "description": "Checks the status of import lookup table data task",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/691e193e-ce1e-4853-b517-7a96de7885aa",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d9b3fcd1-7152-4d43-a58c-eba0f5f59f19",
                "title": "Fortinet FortiSIEM: Check Import Task Status",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "691e193e-ce1e-4853-b517-7a96de7885aa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Check Import Task Status",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "9f0e938f-b12c-4093-b068-3824a66dd064",
                "params": {
                  "taskId": 31973,
                  "lookupTableId": "31972505564"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "check_import_task_status",
                "operationTitle": "Check Import Task Status",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "84cb8250-24ec-4cf6-8ee5-da01fa8bd00a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Check Import Task Status",
              "targetStep": "/api/3/workflow_steps/84cb8250-24ec-4cf6-8ee5-da01fa8bd00a",
              "sourceStep": "/api/3/workflow_steps/691e193e-ce1e-4853-b517-7a96de7885aa",
              "label": null,
              "isExecuted": false,
              "uuid": "22ae17a8-c429-4d53-a923-e26f6c418d8a"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "426a7282-afee-4054-a0a5-8b268bc938b4",
          "id": 4432,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Run Advanced Search Query",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Run search query based on the specified parameters in Fortinet FortiSIEM server",
          "isActive": false,
          "debug": true,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/78200676-1bfb-46ed-a04b-810bec6eca90",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "f8c6a3e7-788e-4a4b-83d1-5a6e780aaf19",
                "title": "Fortinet FortiSIEM: Run Advanced Search Query",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "assets": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "78200676-1bfb-46ed-a04b-810bec6eca90"
            },
            {
              "@type": "WorkflowStep",
              "name": "Run Advanced Search Query",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "cond": "reptDevIpAddr IN (192.168.69.10)",
                  "count": 10,
                  "start": 0,
                  "value": 1,
                  "groupby": "destIpAddr",
                  "orderby": "phRecvTime DESC",
                  "perPage": 1,
                  "AttrList": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                  "rel_time": "Minutes",
                  "reportName": "Top FortiSIEM Events By Severity, Count",
                  "time_selection": "Relative Time"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "run_report",
                "operationTitle": "Run Report",
                "step_variables": []
              },
              "status": null,
              "top": "148",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "cdd2467c-bafa-40e7-ba06-2da69988930d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Run Report",
              "targetStep": "/api/3/workflow_steps/cdd2467c-bafa-40e7-ba06-2da69988930d",
              "sourceStep": "/api/3/workflow_steps/78200676-1bfb-46ed-a04b-810bec6eca90",
              "label": null,
              "isExecuted": false,
              "uuid": "1a0978fa-4870-4cc7-a762-c609a139751f"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "4b2c3bfe-9901-4687-896f-19dc3a7f8ac6",
          "id": 4440,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Get Watch List Entry",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Returns the specific watch list entry for given entry ID.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d21815f2-7f1d-42ce-a177-008dea7a3f36",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Watch List Entry",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f389d823-cde4-49c1-861e-4bc1306d3398",
                "params": {
                  "watch_list_entry_id": "500604"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_watch_list_entry",
                "operationTitle": "Get Watch List Entry",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "460",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2a9d8d53-697c-4d51-aad9-61975f08cdf6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "77a42b87-08b9-4535-84ee-33f0e65bcc36",
                "title": "Fortinet FortiSIEM: Get Watch List Entry",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "100",
              "left": "60",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d21815f2-7f1d-42ce-a177-008dea7a3f36"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Watch List Entry",
              "targetStep": "/api/3/workflow_steps/2a9d8d53-697c-4d51-aad9-61975f08cdf6",
              "sourceStep": "/api/3/workflow_steps/d21815f2-7f1d-42ce-a177-008dea7a3f36",
              "label": null,
              "isExecuted": false,
              "uuid": "f0dfc199-c9a7-418b-a9be-334754066be6"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "53facd7c-41bc-4d02-b262-8867328173fc",
          "id": 4412,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Incident: Comment Incident",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Adds a comment to a specific incident on the Fortinet FortiSIEM server based on the incident ID you have specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/9b1385b2-ecbd-4e2d-882f-b01b6d01e781",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Comment Incident",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "id": "510394",
                  "comment_text": "Testing comment method from fortiSOAR."
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "incident_comment",
                "operationTitle": "Comment Incident",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "228",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "80cf3aa0-2692-42eb-bbd0-fe1628278969"
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "60dec3aa-7769-4f90-b094-3c42c7a0b1b6",
                "title": "Fortinet FortiSIEM: Comment Incident",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "9b1385b2-ecbd-4e2d-882f-b01b6d01e781"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get All Devices",
              "targetStep": "/api/3/workflow_steps/80cf3aa0-2692-42eb-bbd0-fe1628278969",
              "sourceStep": "/api/3/workflow_steps/9b1385b2-ecbd-4e2d-882f-b01b6d01e781",
              "label": null,
              "isExecuted": false,
              "uuid": "52645fdd-3395-44f1-85b2-4a0e921e24b6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "64c548c8-e744-4593-86e2-5638e797ad58",
          "id": 4426,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Incident: Get Incident Details",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Get details of an incident from Fortinet FortiSIEM server based on the incident IDs you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/da4cf863-18b9-4b1e-a1fe-524db6281b08",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Incident Details",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "d84cf8dc-8bf4-4167-81c7-117a11d20515",
                "params": {
                  "value": 2,
                  "fields": "[\"eventName\", \"incidentId\"]",
                  "timeTo": "2022-10-24T18:30:00.000Z",
                  "rel_time": "Hours",
                  "timeFrom": "2022-10-19T18:30:00.000Z",
                  "incidentId": "498080",
                  "select_clause": "",
                  "time_selection": "Relative Time"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_incident_details",
                "operationTitle": "Get Incident Details",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6c82462b-5cc7-45c5-a278-c5ff96636bf1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "047e3847-71fe-4076-93bb-57dbd202bcc4",
                "title": "Fortinet FortiSIEM: Get Incident Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "da4cf863-18b9-4b1e-a1fe-524db6281b08"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Details",
              "targetStep": "/api/3/workflow_steps/6c82462b-5cc7-45c5-a278-c5ff96636bf1",
              "sourceStep": "/api/3/workflow_steps/da4cf863-18b9-4b1e-a1fe-524db6281b08",
              "label": null,
              "isExecuted": false,
              "uuid": "adf45a49-61da-41bc-9c88-16bbea3c9d72"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "6a93360d-6e3b-460c-b906-d05d229cd140",
          "id": 4427,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Update Lookup Table Data",
          "aliasName": null,
          "tag": null,
          "description": "Update an items of a lookup Table based on input parameters you have provided on FortiSIEM server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a5a5e819-b81b-497b-a760-6331ec9c593c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Update Lookup Table Data",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "9f0e938f-b12c-4093-b068-3824a66dd064",
                "params": {
                  "key": "{'url':'sxyz.com'}",
                  "columnData": "{\n  \"url\": \"https://sxyz.com\",\n  \"score\": \"90\"\n}",
                  "lookupTableId": "31972505564"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "update_lookup_table_data",
                "operationTitle": "Update Lookup Table Data",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "231",
              "left": "496",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "4039fd22-7c3a-43e1-9cd0-3dad8db1138b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "18920d01-851f-41fe-813f-fc7ff83c1cfd",
                "title": "Fortinet FortiSIEM: Update Lookup Table Data",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a5a5e819-b81b-497b-a760-6331ec9c593c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Update Lookup Table Data",
              "targetStep": "/api/3/workflow_steps/4039fd22-7c3a-43e1-9cd0-3dad8db1138b",
              "sourceStep": "/api/3/workflow_steps/a5a5e819-b81b-497b-a760-6331ec9c593c",
              "label": null,
              "isExecuted": false,
              "uuid": "e2924f57-4e37-417b-9aae-f8612d8e050c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "6f4946d8-8cc5-454f-8473-a47508ebe9be",
          "id": 4442,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Event: Search Events",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Search events based on filters parameters you have provided",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ab250b11-12d1-4daa-ab3b-d30e3cc73a3a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "9e58777b-2d93-41d6-8772-97ae61a23e48",
                "title": "Fortinet FortiSIEM: Search Events",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "ab250b11-12d1-4daa-ab3b-d30e3cc73a3a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Search Events",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "7dda6fd6-0e6e-4b3b-9b16-56e3937a8891",
                "params": {
                  "start": 0,
                  "value": 4,
                  "perPage": 10,
                  "rel_time": "Hours",
                  "attribute": [
                    "Raw Event Log"
                  ],
                  "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                  "time_selection": "Relative Time",
                  "event_id_operator": "=",
                  "file_name_operator": "CONTAIN",
                  "raw_event_log_value": "port"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "operationTitle": "Search Events",
                "step_variables": []
              },
              "status": null,
              "top": "169",
              "left": "334",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "beca2a41-0c6e-42ee-b2c2-7ff653e6ed32"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Search Events",
              "targetStep": "/api/3/workflow_steps/beca2a41-0c6e-42ee-b2c2-7ff653e6ed32",
              "sourceStep": "/api/3/workflow_steps/ab250b11-12d1-4daa-ab3b-d30e3cc73a3a",
              "label": null,
              "isExecuted": false,
              "uuid": "6e2f0d51-eeb7-45ee-9910-a19236fea467"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "71fd7dd1-0edd-4d7b-b97c-27b7c9624ea9",
          "id": 4416,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Organization: Get Organization Details",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves the details of an organization based on the domain ID that you have specified from Fortinet FortiSIEM server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a2818403-dfd3-4bda-b840-13a55aa799d2",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Organization Details",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "domain_id": "1"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_org_name_by_org_id",
                "operationTitle": "Get Organization Details",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3b29df30-6907-4f40-be7f-ef8fd67edca4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "e7499e83-7ad5-44ec-8d7e-fb6982b4dbc4",
                "title": "Fortinet FortiSIEM: Get Organization Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a2818403-dfd3-4bda-b840-13a55aa799d2"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get All Devices",
              "targetStep": "/api/3/workflow_steps/3b29df30-6907-4f40-be7f-ef8fd67edca4",
              "sourceStep": "/api/3/workflow_steps/a2818403-dfd3-4bda-b840-13a55aa799d2",
              "label": null,
              "isExecuted": false,
              "uuid": "2bf5ecbe-c06a-4f7a-8afc-08e17ce55325"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "72c06c7f-317a-492d-91d9-eefbfe2b1429",
          "id": 4423,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Device: Get All Devices",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves a short description for all devices that are configured on the Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/aff797f1-f66b-4611-9ad2-73ad4584339f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get All Devices",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "a7475113-4864-43bb-81fa-5ec904e06670",
                "params": {
                  "org": ""
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_devices_details",
                "operationTitle": "Get All Devices",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "538de977-3e8c-4ae4-8331-71329bdbfb1b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "5194881a-f2cb-4f7c-a9f4-a7321dbbbbc0",
                "title": "Fortinet FortiSIEM: Get All Devices",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "aff797f1-f66b-4611-9ad2-73ad4584339f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get All Devices",
              "targetStep": "/api/3/workflow_steps/538de977-3e8c-4ae4-8331-71329bdbfb1b",
              "sourceStep": "/api/3/workflow_steps/aff797f1-f66b-4611-9ad2-73ad4584339f",
              "label": null,
              "isExecuted": false,
              "uuid": "3458bfe8-f915-4dd5-83b1-adbf0e0323ed"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "77a7ffae-2f3d-4322-bc55-6552f9b7698c",
          "id": 4415,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Delete Watch List Entry",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "This action allows user to delete watch list entries.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/74d7db99-5d9b-4799-b330-b279205b4970",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Watch List Entry",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "bab68daa-355c-47df-bae1-2c8869f2a163",
                "params": {
                  "watch_list_entry_ids": "883912"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "delete_watch_list_entry",
                "operationTitle": "Delete Watch List Entry",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "264",
              "left": "401",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7016b76a-1480-4c8d-9452-ca8d5c8381ae"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "aff41d5e-8ab1-44eb-866d-ef5635ada527",
                "title": "Fortinet FortiSIEM: Delete Watch List Entry",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "74d7db99-5d9b-4799-b330-b279205b4970"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Watch List Entry",
              "targetStep": "/api/3/workflow_steps/7016b76a-1480-4c8d-9452-ca8d5c8381ae",
              "sourceStep": "/api/3/workflow_steps/74d7db99-5d9b-4799-b330-b279205b4970",
              "label": null,
              "isExecuted": false,
              "uuid": "cb876c97-25dc-4ea3-b927-c9c9b5d176b1"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "7886b993-ad95-4975-930b-642f8d23919c",
          "id": 4410,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Event: Get Events For Incident",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Get all associated events for specified incident",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8be98a57-43f2-490a-9238-3a34c710db5a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Events for Incident",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "to": "",
                  "from": "",
                  "start": 0,
                  "perPage": 500,
                  "incident_id": "510394"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_associated_events",
                "operationTitle": "Get Events For Incident",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "667075cc-80f1-46cb-9247-e5eeb2b8927c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "d7ea4705-042c-4c5d-a75b-50ccced08ff6",
                "title": "Fortinet FortiSIEM: Get Events For Incident",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8be98a57-43f2-490a-9238-3a34c710db5a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get Events for Incident",
              "targetStep": "/api/3/workflow_steps/667075cc-80f1-46cb-9247-e5eeb2b8927c",
              "sourceStep": "/api/3/workflow_steps/8be98a57-43f2-490a-9238-3a34c710db5a",
              "label": null,
              "isExecuted": false,
              "uuid": "f84ef68a-7442-4f82-892e-020c880f2d4a"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8aea6ac9-e3f7-434b-b34b-36386813cbc7",
          "id": 4422,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Device: Get Device Information",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves details of a specific device that is configured on the Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/502e1ac0-b1d3-4870-a8ee-49848e5b1a33",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "34a2caad-b5cc-41c5-aff2-831fc9aa09bf",
                "title": "Fortinet FortiSIEM: Get Device Information",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "502e1ac0-b1d3-4870-a8ee-49848e5b1a33"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Device Information",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "ip": "170.106.76.105",
                  "org": ""
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_device_info",
                "operationTitle": "Get Device Information",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "ad1e5336-9ace-4d20-add9-e98190b32169"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get All Devices",
              "targetStep": "/api/3/workflow_steps/ad1e5336-9ace-4d20-add9-e98190b32169",
              "sourceStep": "/api/3/workflow_steps/502e1ac0-b1d3-4870-a8ee-49848e5b1a33",
              "label": null,
              "isExecuted": false,
              "uuid": "2b7f1635-1fa9-4905-a3e7-1481a44865d6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "96c144dc-92bf-432f-9327-803a9ca2ca5b",
          "id": 4420,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Device: List Monitored Devices and Attributes",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves a list and attributes of all monitored devices that are configured on the Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1477f1f3-4808-41f7-964e-602fbd8a8c86",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "f8ddd455-2eb7-4244-a27b-5be0e457dc56",
                "title": "Fortinet FortiSIEM: List Monitored Devices and Attributes",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "1477f1f3-4808-41f7-964e-602fbd8a8c86"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Monitored Devices and Attributes",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": [],
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_monitored_devices",
                "operationTitle": "List Monitored Devices and Attributes",
                "step_variables": []
              },
              "status": null,
              "top": "129",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "5879b31a-80c3-4a8c-8f51-fb1140d51a3d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get All Devices",
              "targetStep": "/api/3/workflow_steps/5879b31a-80c3-4a8c-8f51-fb1140d51a3d",
              "sourceStep": "/api/3/workflow_steps/1477f1f3-4808-41f7-964e-602fbd8a8c86",
              "label": null,
              "isExecuted": false,
              "uuid": "332dc7b6-9a03-4046-bab4-d58d3c06d8d5"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "9e11b54d-f992-498a-bbcb-2f59e7471420",
          "id": 4404,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Event: Get Event Details",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Get details of specific event on the Fortinet FortiSIEM server based on the event ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/aa5354f7-74d5-4d16-8891-ec057148a72b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Event Details",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "to": "2021-08-24T06:17:17.511Z",
                  "from": "2020-12-12T18:30:00.000Z",
                  "event_id": "1351783580609854511"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_event_details",
                "operationTitle": "Get Event Details",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "249",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "99bcb0ba-c66c-499b-af48-427972a9fb5b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "a0e0157e-b410-420f-ab4b-edc71cba45c6",
                "title": "Fortinet FortiSIEM: Get Event Details",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "aa5354f7-74d5-4d16-8891-ec057148a72b"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Event Details",
              "targetStep": "/api/3/workflow_steps/99bcb0ba-c66c-499b-af48-427972a9fb5b",
              "sourceStep": "/api/3/workflow_steps/aa5354f7-74d5-4d16-8891-ec057148a72b",
              "label": null,
              "isExecuted": false,
              "uuid": "f5e5e8fa-2eec-4f2b-87b1-1d752d390cc8"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "b4922af1-5cf8-44d2-ac7b-90b54a1e0742",
          "id": 4434,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Resource List: Get All Resource Lists",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves list of all resources from Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a9a91f83-a035-477d-b54e-d3c56a7f770d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get All Resource Lists",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "76947ca6-2db4-4e66-891d-d104eb706517",
                "params": [],
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_all_resource_list",
                "operationTitle": "Get All Resource Lists",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "169",
              "left": "328",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6f776100-5a51-4a7b-bd87-bdc4934f2175"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "411cb9e9-127e-46ed-8980-b861b4c448d6",
                "title": "Fortinet FortiSIEM: Get All Resource Lists",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a9a91f83-a035-477d-b54e-d3c56a7f770d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Resource Lists",
              "targetStep": "/api/3/workflow_steps/6f776100-5a51-4a7b-bd87-bdc4934f2175",
              "sourceStep": "/api/3/workflow_steps/a9a91f83-a035-477d-b54e-d3c56a7f770d",
              "label": null,
              "isExecuted": false,
              "uuid": "11ad4439-63c4-477d-9c0b-7aeaa0fd8547"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "b494b208-9fd4-47be-9f9d-6f79d3ed902e",
          "id": 4436,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Resource List: Add Entries To Resource List",
          "aliasName": null,
          "tag": null,
          "description": "Add new elements to resource list based on input parameters you have provided in Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ab35f322-4253-427b-b24b-d38027aedbef",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Add Entries To Resource List",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "76947ca6-2db4-4e66-891d-d104eb706517",
                "params": {
                  "resource_id": "500566",
                  "resource_data": "{\n    \"domainName\": \"pqr.com\"\n  }",
                  "resource_type": "Malware Domains"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "add_entries_to_resource_list",
                "operationTitle": "Add Entries To Resource List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "078cf78e-2b96-4bd6-ab4d-f7cea30b9aca"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3e245670-574f-4634-bf24-00c47da3ec4e",
                "title": "Fortinet FortiSIEM: Add Entries To Resource List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "80",
              "left": "60",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "ab35f322-4253-427b-b24b-d38027aedbef"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Add Entries To Resource List1",
              "targetStep": "/api/3/workflow_steps/078cf78e-2b96-4bd6-ab4d-f7cea30b9aca",
              "sourceStep": "/api/3/workflow_steps/ab35f322-4253-427b-b24b-d38027aedbef",
              "label": null,
              "isExecuted": false,
              "uuid": "6441c5b6-09f5-40f9-aead-31b8826e2a00"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "c115b81f-3f9e-4cf2-8507-f30f0a6cdef8",
          "id": 4438,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Event: Get Event Attribute",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Get event attributes from fortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2c6ec5ad-abac-4dc4-b8c2-c0756c877807",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "abeba0a4-cdc7-4345-aee1-eb56ca04bf76",
                "title": "Fortinet FortiSIEM: Get Incident Attributes",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "2c6ec5ad-abac-4dc4-b8c2-c0756c877807"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Event Attributes",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "7dda6fd6-0e6e-4b3b-9b16-56e3937a8891",
                "params": [],
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_incident_attributes",
                "operationTitle": "Get Incident Attributes",
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "260",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3e899ce3-ddc0-4506-82fe-2a847a9f653f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Incident Attributes",
              "targetStep": "/api/3/workflow_steps/3e899ce3-ddc0-4506-82fe-2a847a9f653f",
              "sourceStep": "/api/3/workflow_steps/2c6ec5ad-abac-4dc4-b8c2-c0756c877807",
              "label": null,
              "isExecuted": false,
              "uuid": "b6e7a1fb-a913-4059-b0cf-0b3a7dd6c75c"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "c25f9632-104f-4d99-b8f8-2af7c949558b",
          "id": 4408,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Add Watch List Entries To Watch List",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "This action allows user to add watch list entry(s) to one or more watch list based on input parameters you have provided.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6c020da7-ea4c-4e38-98e8-5ff35788b8e7",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "2169a685-32c2-4a7b-96c5-8e35358fcbd5",
                "title": "Watch List: Add Watch List Entries To Watch List Groups",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6c020da7-ea4c-4e38-98e8-5ff35788b8e7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Add Watch List Entries To Watch List Groups",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "bab68daa-355c-47df-bae1-2c8869f2a163",
                "params": {
                  "other_params": "{\n  \"inclusive\": false,\n  \"count\": 10,\n  \"custId\": 1,\n  \"triggeringRules\": \"Datastore Space Warning\",\n  \"entryValue\": \"10.132.255.204\",\n  \"ageOut\": \"1d\",\n  \"lastSeen\": 1613601369215,\n  \"firstSeen\": 1613601369215,\n  \"disableAgeout\": false,\n  \"dataCreationType\": \"USER\"\n}",
                  "watch_list_id": "500545"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "add_watch_list_entries_to_watch_list_groups",
                "operationTitle": "Add Watch List Entries To Watch List Groups",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8f18bda7-aa2a-4127-a429-0952bb209f28"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Add Watch List Entries To Watch List Groups",
              "targetStep": "/api/3/workflow_steps/8f18bda7-aa2a-4127-a429-0952bb209f28",
              "sourceStep": "/api/3/workflow_steps/6c020da7-ea4c-4e38-98e8-5ff35788b8e7",
              "label": null,
              "isExecuted": false,
              "uuid": "163e833e-0b09-47db-9773-1c4e692686a1"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cb6b4cd9-4895-4ece-9898-0e7bbe44b4ea",
          "id": 4430,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Create Lookup Table",
          "aliasName": null,
          "tag": null,
          "description": "Create the definition of a lookupTable based on input parameters you have provided on FortiSIEM server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/be9ff462-200d-479e-8c9c-2cfaa2a8bb35",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Lookup Table",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "c2c9133a-8e6f-4f58-b765-8edefa9edafb",
                "params": {
                  "name": "URLList2",
                  "columnList": "[\n  {\n    \"key\": true,\n    \"name\": \"url\",\n    \"type\": \"STRING\"\n  },\n  {\n    \"key\": false,\n    \"name\": \"score\",\n    \"type\": \"DOUBLE\"\n  }\n]",
                  "description": "creating url list",
                  "organizationName": "super"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "create_lookup_table",
                "operationTitle": "Create Lookup Table",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "10df1bd1-55ee-4dd7-adf7-c6d1d4feb66c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "03c72e4e-0acb-4efe-a50b-e462977b2e57",
                "title": "Fortinet FortiSIEM: Create Lookup Table",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "be9ff462-200d-479e-8c9c-2cfaa2a8bb35"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Create Lookup Table",
              "targetStep": "/api/3/workflow_steps/10df1bd1-55ee-4dd7-adf7-c6d1d4feb66c",
              "sourceStep": "/api/3/workflow_steps/be9ff462-200d-479e-8c9c-2cfaa2a8bb35",
              "label": null,
              "isExecuted": false,
              "uuid": "d8ff7ed9-d2a8-4ce7-873b-a69afb72cc00"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cd6d6750-1600-4d47-86c4-9c743bc4fe2d",
          "id": 4406,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Events Data By Query ID",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves data of events/incidents by input query ID",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/c3a453fd-8882-493f-97b5-6109234a7c27",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Events Data By Query ID",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "e7609c95-4180-447d-be5e-abf789a478cf",
                "params": {
                  "start": 10,
                  "perPage": 50,
                  "query_id": "'2485025,1629805421261'"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_events_by_query_id",
                "operationTitle": "Get Events Data By Query ID",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "340",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "645f7088-7be0-4e43-a575-be19b86fe386"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d859a4c2-8c74-49a3-98f7-80cd7f37eeae",
                "title": "Fortinet FortiSIEM: Get Events Data By Query ID",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "c3a453fd-8882-493f-97b5-6109234a7c27"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Events Data By Query ID",
              "targetStep": "/api/3/workflow_steps/645f7088-7be0-4e43-a575-be19b86fe386",
              "sourceStep": "/api/3/workflow_steps/c3a453fd-8882-493f-97b5-6109234a7c27",
              "label": null,
              "isExecuted": false,
              "uuid": "700fc3db-d04a-481d-97bd-882d132c203a"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "d3b3fc4f-e7d0-49c7-9201-4661cd054e40",
          "id": 4419,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Incident: Clear Incident With Reason",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Clears an incident with the reason you have specified on the Fortinet FortiSIEM server based on the incident ID you have specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/0040d365-4e8f-44e4-ac2f-9117b3407caa",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "2d1011ab-e7ca-4372-bfb3-7c469e0710fb",
                "title": "Fortinet FortiSIEM: Clear Incident With Reason",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "0040d365-4e8f-44e4-ac2f-9117b3407caa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Clear Incident With Reason",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": {
                  "id": "510394",
                  "comment_text": "testing method from FortiSOAR"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "clear_incident",
                "operationTitle": "Clear Incident With Reason",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f6f263f6-8a4f-429a-9e0c-e043fe5f5826"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Clear Incident With Reason",
              "targetStep": "/api/3/workflow_steps/f6f263f6-8a4f-429a-9e0c-e043fe5f5826",
              "sourceStep": "/api/3/workflow_steps/0040d365-4e8f-44e4-ac2f-9117b3407caa",
              "label": null,
              "isExecuted": false,
              "uuid": "fec14b42-2f9a-4eae-8f75-0d0bf645155e"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "d8a6a814-de63-414a-b528-94248d3314a9",
          "id": 4411,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Get Watch List Entries Count",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Returns the count of watch list entries in any watch list",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1754fcc7-8fd7-4c71-84bf-0f340c12b443",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "155a4d7d-2276-472f-a8d0-67665764f465",
                "title": "Fortinet FortiSIEM: Get Watch List Entries Count",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "1754fcc7-8fd7-4c71-84bf-0f340c12b443"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Watch List Entries Count",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f389d823-cde4-49c1-861e-4bc1306d3398",
                "params": [],
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_watch_list_entries_count",
                "operationTitle": "Get Watch List Entries Count",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "d4f23569-9b32-4a41-95e7-24a3e5858110"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Watch List Entries Count",
              "targetStep": "/api/3/workflow_steps/d4f23569-9b32-4a41-95e7-24a3e5858110",
              "sourceStep": "/api/3/workflow_steps/1754fcc7-8fd7-4c71-84bf-0f340c12b443",
              "label": null,
              "isExecuted": false,
              "uuid": "eb50b0c5-1117-475c-9760-90954b63ab6f"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "d93c59a9-faa3-4171-9ab0-d4b57409237e",
          "id": 4424,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Resource List: Remove Entries From Resource List",
          "aliasName": null,
          "tag": null,
          "description": "Remove elements from resource list based on input parameters you have provided in Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8751de08-b728-4895-bfec-17c2e7e577a3",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "8641326f-3b98-4d0b-b912-4038abb62f66",
                "title": "Fortinet FortiSIEM: Remove Entries From Resource List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8751de08-b728-4895-bfec-17c2e7e577a3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Remove Entries from Resource List",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "76947ca6-2db4-4e66-891d-d104eb706517",
                "params": {
                  "resource_ids": "15933023788",
                  "resource_type": "Malware Urls"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "remove_entries_from_resource_list",
                "operationTitle": "Remove Entries from Resource List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "260",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "dfb0ee91-fbd9-454d-accf-d40a0b1bd8c1"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Remove Entries from Resource List",
              "targetStep": "/api/3/workflow_steps/dfb0ee91-fbd9-454d-accf-d40a0b1bd8c1",
              "sourceStep": "/api/3/workflow_steps/8751de08-b728-4895-bfec-17c2e7e577a3",
              "label": null,
              "isExecuted": false,
              "uuid": "6c6ef268-63be-4d3c-a60f-9bc7af0fae2c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "dbb24f00-6046-4a3c-bd19-2cc3bb25c722",
          "id": 4443,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Organization: List Monitored Organizations",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "Retrieves a list of all monitored organizations that are configured on the Fortinet FortiSIEM server",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/783fa4bc-1eb3-4504-80b9-3b180c569e1a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Alerts",
              "description": null,
              "arguments": {
                "route": "ecd903f4-ec42-4b98-b840-3150ad7e769f",
                "title": "Fortinet FortiSIEM: List Monitored Organizations",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "783fa4bc-1eb3-4504-80b9-3b180c569e1a"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Monitored Organizations",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "0b48ae70-408f-4a3e-8641-cf8d93b3257a",
                "params": [],
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "get_monitored_organizations",
                "operationTitle": "List Monitored Organizations",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e529171a-6a8c-4928-8a34-163750041d37"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Alerts -> Get All Devices",
              "targetStep": "/api/3/workflow_steps/e529171a-6a8c-4928-8a34-163750041d37",
              "sourceStep": "/api/3/workflow_steps/783fa4bc-1eb3-4504-80b9-3b180c569e1a",
              "label": null,
              "isExecuted": false,
              "uuid": "48b7e76b-0a5e-43f1-b045-e622a45c3981"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "dcf01081-ab6b-44f6-b03d-20ef3cfefd07",
          "id": 4431,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Delete Lookup Table Data",
          "aliasName": null,
          "tag": null,
          "description": "Delete an items of a lookup Table based on input parameters you have provided on FortiSIEM server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/93e7c9f0-a031-46e1-a30d-5ce3182db58e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "397a3171-6e44-42c8-b49f-1063d6549cc0",
                "title": "Fortinet FortiSIEM: Delete Lookup Table Data",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "93e7c9f0-a031-46e1-a30d-5ce3182db58e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Lookup Table Data",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "9f0e938f-b12c-4093-b068-3824a66dd064",
                "params": {
                  "keys_data": "[\n  {\n    \"url\": \"www.test.com\"\n  },\n  {\n    \"url\": \"https://sxyz.com\"\n  }\n]",
                  "lookupTableId": "31972505564"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "delete_lookup_table_data",
                "operationTitle": "Delete Lookup Table Data",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "db91562d-b06c-481f-9149-39fb4b4aedc1"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Lookup Table Data",
              "targetStep": "/api/3/workflow_steps/db91562d-b06c-481f-9149-39fb4b4aedc1",
              "sourceStep": "/api/3/workflow_steps/93e7c9f0-a031-46e1-a30d-5ce3182db58e",
              "label": null,
              "isExecuted": false,
              "uuid": "969278e8-e550-4d5a-af6c-3baad9258a1c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "e095bda8-1891-42f1-a6db-a7aa61422e6a",
          "id": 4405,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Lookup Table: Delete Lookup Table",
          "aliasName": null,
          "tag": null,
          "description": "Allows you to delete the lookupTable definition from FortiSIEM server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/861785e2-a9a0-4cf7-9e64-3b1ab1f6e3b4",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Lookup Table",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "c2c9133a-8e6f-4f58-b765-8edefa9edafb",
                "params": {
                  "lookupTableId": "31972505565"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "delete_lookup_table",
                "operationTitle": "Delete Lookup Table",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "199",
              "left": "355",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "60f1a752-e7df-4f99-b6fe-ea90d3c21e60"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "0f9d7329-0b15-4b18-85ff-26b2ebb871dc",
                "title": "Fortinet FortiSIEM: Delete Lookup Table",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "861785e2-a9a0-4cf7-9e64-3b1ab1f6e3b4"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Lookup Table",
              "targetStep": "/api/3/workflow_steps/60f1a752-e7df-4f99-b6fe-ea90d3c21e60",
              "sourceStep": "/api/3/workflow_steps/861785e2-a9a0-4cf7-9e64-3b1ab1f6e3b4",
              "label": null,
              "isExecuted": false,
              "uuid": "1f127d7e-de49-4a4d-961e-a638f4944d0f"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "e0a4ecd1-f448-444d-8cce-78da5df14c38",
          "id": 4413,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "FortiSIEM > Ingest",
          "aliasName": null,
          "tag": "#fortinet-fortisiem #ingest #dataingestion #create",
          "description": "This playbook demonstrate the list incident operation.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a80095ca-7046-4579-ba76-f6eea2cd7146",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "List Incident",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/1dd26258-863e-44cd-b184-f9ccd92300ec"
              },
              "status": null,
              "top": "166",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "1ebc1c83-c752-458d-94ee-d804f68b5272"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Alert Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.FortiSIEMMacroName}}",
                  "value": "{{vars.steps.List_Incident.current_time}}"
                },
                "version": "3.2.0",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "560",
              "left": "820",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "241561e4-8133-4b57-8cb1-2e15916f238b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Associated Events",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Create_Record}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "arguments": {
                  "max_events": "{{vars.event_count}}",
                  "incidentdata": "{{vars.item}}"
                },
                "apply_async": true,
                "step_variables": [],
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/2f83ebaf-5df3-420e-a4f0-41f3f2f04384"
              },
              "status": null,
              "top": "660",
              "left": "1020",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "62321345-1f98-4e5a-b611-63c458071532"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.incident_source_data}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "name": "{{vars.item.eventName}}-{{vars.item.eventType}}",
                  "type": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                  "state": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                  "domain": "{{vars.item.incidentTarget.domain or None }}",
                  "source": "Fortinet FortiSIEM",
                  "status": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                  "tenant": "{{vars.tenant_name[vars.item.customer] | default('null')}}",
                  "severity": "{{vars.item.eventSeverityCat | resolveRange(vars.alerts_severity_map)}}",
                  "sourceId": "{{vars.item[\"incidentId\"]}}",
                  "sourceIp": "{{vars.item.incidentSrc.srcIpAddr or None}}",
                  "userName": "{{vars.item.incidentTarget.user or None}}",
                  "__replace": "true",
                  "epochTime": "{{vars.item[\"incidentLastSeen\"]}}",
                  "eventTime": "{{arrow.get(vars.item[\"incidentLastSeen\"]).to(\"UTC\").format(\"YYYY-MM-DD HH:mm:ss ZZ\")}}",
                  "sourcedata": "{{vars.item | toJSON}}",
                  "description": "<div class=\"font-size-16 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\">{{vars.item.incidentTitle or vars.item.eventName or 'N/A'}}</h4></div>\n<table style=\"border-color: #04080c;\" border=\"1\" class=\"font-normal\">\n<tbody><tr><td>\n\n\n{%if vars.item.incidentSrc%} \n<div class=\"font-size-14 ng-binding\">Incident Source</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.incidentSrc}}</div>\n</div>\n{%endif%}\n\n\n{%if vars.item.incidentTarget%}\n<div class=\"font-size-14 ng-binding\">Incident Target</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.incidentTarget}}</div>\n</div>\n{%endif%}\n\n{%if vars.item.incidentRptIp%}\n<div class=\"font-size-14 ng-binding\">Incident Reporting IP</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.incidentRptIp}}</div>\n</div>\n{%endif%}\n\n\n{%if vars.item.incidentSrc or vars.item.incidentRptDevName or vars.item.incidentRptIp %}\n<div class=\"font-size-14 ng-binding\">Reporting Device</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.incidentSrc or vars.item.incidentRptDevName or vars.item.incidentRptIp}}</div>\n</div>\n{%endif%}\n\n{%if 'CVE' in vars.item.incidentComments %}\n<div class=\"font-size-14 ng-binding\">Detected CVE</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.incidentComments|regex_search(\"CVE[^]]*\")}}</div>\n</div>\n{%endif%}\n\n{%if vars.item.phIncidentImpacts %}\n<div class=\"font-size-14 ng-binding\">Incident Impacts</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.phIncidentImpacts}}</div>\n</div>\n{%endif%}\n\n{%if vars.item.incidentComments%}\n<div class=\"font-size-14 ng-binding\">Incident Analysts Comments</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.incidentComments}}</div>\n</div>\n{%endif%}\n\n\n{%if vars.item.attackTechnique%}\n<div class=\"font-size-14 ng-binding\">Attack Technique</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.attackTechnique}}</div>\n</div>\n{%endif%}\n\n{%if vars.item.incidentDetail%}\n<div class=\"font-size-14 ng-binding\">Incident Details</div><div class=\"card-container-body\" style=\"width: 100%;font-size:46px;\">\n<div class=\"card-number\" style=\"font-size:20px;  border-left: 5px solid red;background:#141b23\">{{vars.item.incidentDetail.replace(',',' ')}}</div>\n</div>\n{%endif%}\n\n<table style=\"color:white;font-size:11;\">\n<tbody><tr></tr><tr>\n\n\n</tr><tr>\n\n\n</tr><tr>\n\n\n</tr><tr>\n\n\n</tr><tr>\n\n\n</tr><tr>\n\n\n</tr><tr>\n\n\n</tr><tr>\n\n\n</tr>\n</tbody></table></td></tr></tbody></table>",
                  "targetAsset": "{{vars.item.incidentTarget.hostIpAddr or None}}",
                  "ackSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "computerName": "{{vars.item.incidentTarget.hostName or vars.item.incidentTarget.destName or None}}",
                  "destinationIp": "{{vars.item.incidentTarget.destIpAddr or None}}",
                  "mitreattackid": "{{vars.item[\"attackTechnique\"][0][\"techniqueid\"] or None}}",
                  "respSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "mitreTechnique": "{{vars.item.attackTactic or None}}",
                  "priorityWeight": 1,
                  "escalatedtoincident": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                  "alertRemainingAckSLA": 0
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "620",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "62e7630f-89f4-4123-8d01-27ca12bfcf60"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "event_count": "{{ vars.result.event_count }}",
                "tenant_name": "{{vars.result.tenant_mapping | default({})}}",
                "alerts_type_map": "{}",
                "alerts_state_map": "{}",
                "alerts_status_map": "{}",
                "FortiSIEMMacroName": "{{vars.result.FortiSIEMMacroName }}",
                "alerts_severity_map": "{'MINIMAL': {{'Severity'| picklist('Minimal') }}, 'LOW': {{'Severity'| picklist('Low') }}, 'MEDIUM': {{'Severity'| picklist('Medium') }}, 'HIGH': {{'Severity'| picklist('High') }}, 'CRITICAL': {{'Severity'| picklist('Critical') }}}",
                "incident_source_data": "{{ vars.result.data }}",
                "link_mitre_technique": "{{vars.result.link_mitre_technique}}",
                "alerts_escalatedtoincident_map": "{}"
              },
              "status": null,
              "top": "306",
              "left": "413",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "7dcaee95-a3bf-4d27-a4a6-8080d7694a4c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "08dbc62c-ba84-4237-8196-857b857c030f",
                "title": "FortiSIEM > Ingest",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a80095ca-7046-4579-ba76-f6eea2cd7146"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create Record -> Update Last Alert Pull Time",
              "targetStep": "/api/3/workflow_steps/241561e4-8133-4b57-8cb1-2e15916f238b",
              "sourceStep": "/api/3/workflow_steps/62e7630f-89f4-4123-8d01-27ca12bfcf60",
              "label": null,
              "isExecuted": false,
              "uuid": "8abc5989-100b-424d-bf5d-0bc465aeacbb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Config -> Create Alert1",
              "targetStep": "/api/3/workflow_steps/62e7630f-89f4-4123-8d01-27ca12bfcf60",
              "sourceStep": "/api/3/workflow_steps/7dcaee95-a3bf-4d27-a4a6-8080d7694a4c",
              "label": null,
              "isExecuted": false,
              "uuid": "0748a77b-bf8a-4a9f-8185-9e649cdeaab5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Last Alert Pull Time -> Fetch Associated Events",
              "targetStep": "/api/3/workflow_steps/62321345-1f98-4e5a-b611-63c458071532",
              "sourceStep": "/api/3/workflow_steps/241561e4-8133-4b57-8cb1-2e15916f238b",
              "label": null,
              "isExecuted": false,
              "uuid": "15fb895b-af2a-46b6-864d-ca0ec6a8d0db"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> List Incident",
              "targetStep": "/api/3/workflow_steps/1ebc1c83-c752-458d-94ee-d804f68b5272",
              "sourceStep": "/api/3/workflow_steps/a80095ca-7046-4579-ba76-f6eea2cd7146",
              "label": null,
              "isExecuted": false,
              "uuid": "3fcde64a-9db9-4c5f-8931-c7b138fb5772"
            },
            {
              "@type": "WorkflowRoute",
              "name": "List Incident -> Config",
              "targetStep": "/api/3/workflow_steps/7dcaee95-a3bf-4d27-a4a6-8080d7694a4c",
              "sourceStep": "/api/3/workflow_steps/1ebc1c83-c752-458d-94ee-d804f68b5272",
              "label": null,
              "isExecuted": false,
              "uuid": "0576acc0-149f-4f38-bb2f-16458d0ad33b"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "e36d6d38-8096-480a-a8ed-7ce60b61cb6a",
          "id": 4428,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "create",
            "dataingestion",
            "fortinet-fortisiem",
            "ingest"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Watch List: Delete Watch List",
          "aliasName": null,
          "tag": "#FortiSIEM",
          "description": "This action allows user to delete watch lists",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686301255,
          "collection": "/api/3/workflow_collections/cb1ed0d5-9e10-4706-9687-bd3808dd78ba",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b383027e-5d09-4e0c-b69e-3c49d18b62ac",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "876d5e21-8eea-4aca-8482-85a96fa00554",
                "title": "Fortinet FortiSIEM: Delete Watch List",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "b383027e-5d09-4e0c-b69e-3c49d18b62ac"
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Watch List",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "bab68daa-355c-47df-bae1-2c8869f2a163",
                "params": {
                  "watch_list_ids": "24011549903"
                },
                "version": "5.0.3",
                "connector": "fortinet-fortisiem",
                "operation": "delete_watch_list",
                "operationTitle": "Delete Watch List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "520",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e6cd50d1-b9bd-4461-9097-cc7889b9d4dc"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Delete Watch List",
              "targetStep": "/api/3/workflow_steps/e6cd50d1-b9bd-4461-9097-cc7889b9d4dc",
              "sourceStep": "/api/3/workflow_steps/b383027e-5d09-4e0c-b69e-3c49d18b62ac",
              "label": null,
              "isExecuted": false,
              "uuid": "466ef0de-7e54-4db5-b43e-f631aae3f051"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "eddb9ee1-c0c1-461e-a1c5-f54f782c746d",
          "id": 4441,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortisiem"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "dataingestion",
    "fortinet-fortisiem",
    "Fortinet",
    "fetch",
    "create",
    "ingest"
  ]
}