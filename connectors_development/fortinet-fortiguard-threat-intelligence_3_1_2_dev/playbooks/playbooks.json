{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Fortinet FortiGuard Threat Intelligence - 3.1.2",
      "description": "FortiGuard Threat Intelligence is the global threat intelligence and research organization at Fortinet. This connector facilitates automated operations to check IP, URL, Domain and File Hash Lookup\u2019s and ingestion of daily threat feeds.<br/><br/>This connector has a dependency on the <a href=\"/content-hub/all-content/?contentType=solutionpack&amp;tag=ThreatIntelManagement\" target=\"_blank\" rel=\"noopener\">Threat Intel Management Solution Pack</a>. Install the Solution Pack before enabling ingestion of Threat Feeds from this source.",
      "visible": true,
      "image": null,
      "uuid": "70d5e5ae-7ff3-4fe7-9c58-819afd457001",
      "id": 49,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "Fortinet",
        "fortinet-fortiguard-threat-intelligence"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Threat Intel Search",
          "aliasName": null,
          "tag": "#Fortinet FortiGuard Threat Intelligence",
          "description": "Retrieves information about a threat from Fortiguard Threat Intelligence based on the indicator you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1694153925,
          "collection": "/api/3/workflow_collections/70d5e5ae-7ff3-4fe7-9c58-819afd457001",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/febc4e44-0cbb-4ed5-8083-15e2914b18bc",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "6edc8bb1-feca-48e7-89ae-2108c673433d",
                "title": "Fortinet FortiGuard Threat Intelligence: Threat Intel Search",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "febc4e44-0cbb-4ed5-8083-15e2914b18bc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Threat Intel Search",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiGuard Threat Intelligence",
                "config": "d168d1c5-1842-4e1a-ac52-4ba96432e481",
                "params": {
                  "indicator": "1.1.1.1"
                },
                "version": "3.1.2",
                "connector": "fortinet-fortiguard-threat-intelligence",
                "operation": "threat_intel_search",
                "operationTitle": "Threat Intel Search",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3124f7b4-a123-44f9-955a-7a9f4e0452d9"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Threat Intel Search",
              "targetStep": "/api/3/workflow_steps/3124f7b4-a123-44f9-955a-7a9f4e0452d9",
              "sourceStep": "/api/3/workflow_steps/febc4e44-0cbb-4ed5-8083-15e2914b18bc",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d9e280e4-35c3-41c4-95ee-5c3e8833f211"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "0bef94d7-fc01-4731-aa0b-67ae00735cb1",
          "id": 598,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortiguard-threat-intelligence"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> FortiGuard Threat Intelligence > Fetch and Create",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "ingestedData"
          ],
          "synchronous": false,
          "lastModifyDate": 1664307357,
          "collection": "/api/3/workflow_collections/70d5e5ae-7ff3-4fe7-9c58-819afd457001",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/adbcfc33-d538-41d3-9db7-960eed0dc12b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "tlp": "Amber",
                "tlp_map": "{'Red': {{'TrafficLightProtocol' | picklist('Red', 'uuid')}}','Amber':{{'TrafficLightProtocol' | picklist('Amber', 'uuid')}}','Green':{{'TrafficLightProtocol' | picklist('Green','uuid')}},'White': {{'TrafficLightProtocol' | picklist('White', 'uuid')}}}",
                "confidence": "50",
                "reputation": "Suspicious",
                "reputation_map": "{'Good': \"{{'IndicatorReputation' | picklist('Good', 'uuid')}}\",'Suspicious': \"{{'IndicatorReputation' | picklist('Suspicious', 'uuid')}}\",'Malicious': \"{{'IndicatorReputation' | picklist('Malicious', 'uuid')}}\",'No Reputation Available': \"{{'IndicatorReputation' | picklist('No Reputation Available', 'uuid')}}\",'TBD': \"{{'IndicatorReputation' | picklist('TBD', 'uuid')}}\"}",
                "typeOfFeed_map": "{'domain': \"{{'ThreatIntelFeedType' | picklist('Domain', 'uuid')}}\",'url': \"{{'ThreatIntelFeedType' | picklist('URL', 'uuid')}}\", 'ip_port': \"{{'ThreatIntelFeedType' | picklist('Network Activity', 'uuid')}}\",'ip': \"{{'ThreatIntelFeedType' | picklist('IP Address', 'uuid')}}\", 'file_hash_sha256': \"{{'ThreatIntelFeedType' | picklist('FileHash-SHA256', 'uuid')}}\", 'file_hash_sha1': \"{{'ThreatIntelFeedType' | picklist('FileHash-SHA1', 'uuid')}}\", 'file_hash_md5': \"{{'ThreatIntelFeedType' | picklist('FileHash-MD5', 'uuid')}}\"}",
                "threatTypes_map": "{\"anonymization\": \"{{'Threat Type' | picklist('Anonymization', 'uuid')}}\", 'bot': \"{{'Threat Type' | picklist('Bot', 'uuid')}}\", 'cc_skimming': \"{{'Threat Type' | picklist('Credit Card Skimming', 'uuid')}}\", 'cryptocurrency_mining': \"{{'Threat Type' | picklist('Cryptocurrency Mining', 'uuid')}}\", 'malware': \"{{'Threat Type' | picklist('Malware', 'uuid')}}\", 'malware_cnc': \"{{'Threat Type' | picklist('Malware C2', 'uuid')}}\", 'phishing': \"{{'Threat Type' | picklist('Phishing', 'uuid')}}\",'pup': \"{{'Threat Type' | picklist('Potential Unwanted Program (PUP)', 'uuid')}}\", 'pup_cnc': \"{{'Threat Type' | picklist('PUP Spyware C2', 'uuid')}}\", 'scanner': \"{{'Threat Type' | picklist('Scanner', 'uuid')}}\", 'spam_sender': \"{{'Threat Type' | picklist('Spam Sender', 'uuid')}}\", 'spam_url': \"{{'Threat Type' | picklist('Spam URL', 'uuid')}}\", 'potential_malware': \"{{'Threat Type' | picklist('Potential Malware', 'uuid')}}\", 'potential_phishing': \"{{'Threat Type' | picklist('Potential Phishing', 'uuid')}}\", 'potential_spam': \"{{'Threat Type' | picklist('Potential Spam', 'uuid')}}\"}",
                "killChainPhases_map": "{\"reconnaissance\": \"{{'KillChainPhases' | picklist('Reconnaissance', 'uuid')}}\", \"weaponization\": \"{{'KillChainPhases' | picklist('Weaponization', 'uuid')}}\", \"delivery\": \"{{'KillChainPhases' | picklist('Delivery', 'uuid')}}\", \"exploitation\": \"{{'KillChainPhases' | picklist('Exploitation', 'uuid')}}\", \"installation\": \"{{'KillChainPhases' | picklist('Installation', 'uuid')}}\", \"command-and-control\": \"{{'KillChainPhases' | picklist('Command & Control', 'uuid')}}\", \"actions-on-objectives\": \"{{'KillChainPhases' | picklist('Actions on Objectives', 'uuid')}}\"}"
              },
              "status": null,
              "top": "120",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "876bb39f-151e-4693-9ddc-11639433be3a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params.ingestedData}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 8000
                },
                "resource": {
                  "tLP": "{{vars.tlp_resolved}}",
                  "label": "{{vars.item.labels | toJSON}}",
                  "value": "{{ vars.item.name.split(\": \")[1].strip() }}",
                  "source": "FortiGuard Threat Intelligence",
                  "created": "{% if vars.item.created %}{{arrow.get(vars.item.created).int_timestamp}}{% endif %}",
                  "pattern": "{{vars.item.pattern}}",
                  "modified": "{% if vars.item.modified %}{{arrow.get(vars.item.modified).int_timestamp}}{% endif %}",
                  "sourceId": "{{ vars.item.id.split(\"--\")[-1] }}",
                  "__replace": "true",
                  "expiresOn": "{% if vars.expiry %}{% if vars.item.valid_from %}{{ arrow.get(vars.item.valid_from).int_timestamp + (vars.expiry | int)*24*60*60 }}{% else %}None{% endif %}{% endif %}",
                  "validFrom": "{% if vars.item.valid_from %}{{arrow.get(vars.item.valid_from).int_timestamp}}{% endif %}",
                  "confidence": "{% if vars.item.confidence %}{{ vars.item.confidence }}{% else %}{{ vars.confidence }}{% endif %}",
                  "recordTags": "{% if vars.item.labels | length > 1 %}{{ vars.item.labels[1].split(\"tags:\")[-1].split(\",\") }}{% endif %}",
                  "reputation": "{{vars.reputation_resolved}}",
                  "sourceData": "{{ vars.item | toJSON}}",
                  "typeOfFeed": "{{ vars.item.name.split(\": \")[0].strip() | resolveRange(vars.typeOfFeed_map) }}",
                  "validUntil": "{% if vars.item.valid_until %}{{arrow.get(vars.item.valid_until).int_timestamp}}{% else %}None{% endif %}",
                  "description": "{{ vars.item.description }}",
                  "threatTypes": "{% if vars.item.labels and 'threat_types' in vars.item.labels[0] %}{%set types=[] %}{% for type in vars.item.labels[0].split(\"threat_types:\")[-1].split(\",\") %}{% set _temp=types.append(type | resolveRange(vars.threatTypes_map)) %}{% endfor %}{{types}}{% else %}None{% endif %}",
                  "killChainPhases": "{% if vars.item.kill_chain_phases %}['{{ vars.item.kill_chain_phases[0].phase_name | resolveRange(vars.killChainPhases_map) }}']{% else %}None{% endif %}"
                },
                "_showJson": false,
                "collection": "/api/ingest-feeds/threat_intel_feeds",
                "__recommend": [],
                "step_variables": []
              },
              "status": null,
              "top": "460",
              "left": "980",
              "stepType": "/api/3/workflow_step_types/7b221880-716b-4726-a2ca-5e568d330b3e",
              "group": null,
              "uuid": "09b80f07-d280-4c93-b5ae-c1efec41968a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is data only for mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, For Mapping",
                    "step_iri": "/api/3/workflow_steps/cf5e0ae5-356a-4739-80bb-925cc4c22107",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Return Sample Data"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/09b80f07-d280-4c93-b5ae-c1efec41968a",
                    "step_name": "Create Record"
                  }
                ]
              },
              "status": null,
              "top": "300",
              "left": "620",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "f61154f4-dade-4def-a0dc-164bc49e77c6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Resolve Range",
              "description": null,
              "arguments": {
                "tlp_resolved": "{{vars.tlp | resolveRange(vars.tlp_map)}}",
                "reputation_resolved": "{{vars.reputation | resolveRange(vars.reputation_map)}}"
              },
              "status": null,
              "top": "200",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "44c748fb-2384-44d3-ab55-8ffe9ff95efd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Sample Data",
              "description": null,
              "arguments": {
                "data": "[{\n\t\"id\": \"indicator--10566256-faa2-5e44-803f-d2fc2c8a5c93\",\n\t\"name\": \"ip: 45.83.64.186\",\n\t\"description\": \"threat_types:scanner; tags:Log4Shell,CVE-2021-44228,Scanner,Log4j RCE,Log4j\",\n\t\"pattern\": \"[ipv4-addr:value = '45.83.64.186']\",\n\t\"labels\": [\"threat_types:scanner\", \"tags:Log4Shell,CVE-2021-44228,Scanner,Log4j RCE,Log4j\"],\n\t\"confidence\": 50,\n\t\"created\": \"2021-12-13T18:38:53Z\",\n\t\"modified\": \"2022-03-16T07:39:35Z\",\n\t\"valid_from\": \"2021-12-13T18:38:53Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"exploitation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--15d51b54-2ba8-5caf-8757-cdc20f315611\",\n\t\"name\": \"ip: 213.91.181.117\",\n\t\"description\": \"threat_types:scanner; tags:Scanner\",\n\t\"pattern\": \"[ipv4-addr:value = '213.91.181.117']\",\n\t\"labels\": [\"threat_types:scanner\", \"tags:Scanner\"],\n\t\"confidence\": 50,\n\t\"created\": \"2021-11-23T02:49:27Z\",\n\t\"modified\": \"2022-03-16T07:39:31Z\",\n\t\"valid_from\": \"2021-11-23T02:49:27Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"exploitation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--0b76df10-f988-5626-ab6b-12ca62f3a682\",\n\t\"name\": \"url: http://180.182.225.138:48148/Mozi.a\",\n\t\"description\": \"threat_types:malware; tags:Mozi,Elf\",\n\t\"pattern\": \"[url:value = 'http://180.182.225.138:48148/Mozi.a']\",\n\t\"labels\": [\"threat_types:malware\", \"tags:Mozi,Elf\"],\n\t\"confidence\": 85,\n\t\"created\": \"2022-03-16T07:00:32Z\",\n\t\"modified\": \"2022-03-16T07:00:35Z\",\n\t\"valid_from\": \"2022-03-16T07:00:32Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"installation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--04cecdb1-9f41-5bcb-a3e6-f1847f0c711f\",\n\t\"name\": \"url: http://27.41.52.101:37688/Mozi.m\",\n\t\"description\": \"threat_types:malware; tags:Mozi,Elf\",\n\t\"pattern\": \"[url:value = 'http://27.41.52.101:37688/Mozi.m']\",\n\t\"labels\": [\"threat_types:malware\", \"tags:Mozi,Elf\"],\n\t\"confidence\": 85,\n\t\"created\": \"2022-03-16T07:00:32Z\",\n\t\"modified\": \"2022-03-16T07:00:35Z\",\n\t\"valid_from\": \"2022-03-16T07:00:32Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"installation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n},{\n\t\"id\": \"indicator--2416e87c-0c73-5e5d-b5bf-b8423ce47419\",\n\t\"name\": \"domain: babacocpoo.duckdns.org\",\n\t\"description\": \"threat_types:malware,phishing; tags:Phishing,Apple phishing,MoqHao\",\n\t\"pattern\": \"[domain-name:value = 'babacocpoo.duckdns.org']\",\n\t\"labels\": [\"threat_types:malware,phishing\", \"tags:Phishing,Apple phishing,MoqHao\"],\n\t\"confidence\": 85,\n\t\"created\": \"2022-03-16T08:52:49Z\",\n\t\"modified\": \"2022-03-16T08:52:49Z\",\n\t\"valid_from\": \"2022-03-16T08:52:49Z\",\n\t\"kill_chain_phases\": [{\n\t\t\"kill_chain_name\": \"lockheed-martin-cyber-kill-chain\",\n\t\t\"phase_name\": \"exploitation\"\n\t}],\n\t\"spec_version\": \"2.1\",\n\t\"type\": \"indicator\",\n\t\"pattern_type\": \"stix\"\n}]"
              },
              "status": null,
              "top": "140",
              "left": "980",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "cf5e0ae5-356a-4739-80bb-925cc4c22107"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Confidence\",\n    \"name\": \"confidence\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default Confidence score to be set for the feeds, in case the feed record doesn't have a confidence score\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 50,\n    \"validation\": {\n       \"minlength\": 0,\n       \"maxlength\": 100\n    }\n  },\n  {\n    \"title\": \"Reputation\",\n    \"name\": \"reputation\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default Reputation to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Good\", \"Suspicious\", \"Malicious\", \"No Reputation Available\", \"TBD\"],\n    \"value\": \"Suspicious\"\n  },\n  {\n    \"title\": \"TLP\",\n    \"name\": \"tlp\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default TLP to be set for the feeds\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\"Red\", \"Amber\", \"Green\", \"White\"],\n    \"value\": \"White\"\n  },\n{\n    \"title\": \"Maximum Age (in days)\",\n    \"name\": \"expiry\",\n    \"type\": \"integer\",\n    \"tooltip\": \"Default age for the feeds. The indicator expires on 'valid_until' date unless a different expiry is specified here. If specified, the indicator will be marked expired on valid_from + expiry.\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 7\n  }\n]"
                }
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "adbcfc33-d538-41d3-9db7-960eed0dc12b"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Resolve Range",
              "targetStep": "/api/3/workflow_steps/44c748fb-2384-44d3-ab55-8ffe9ff95efd",
              "sourceStep": "/api/3/workflow_steps/876bb39f-151e-4693-9ddc-11639433be3a",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "eb184665-630f-4b0b-80cc-176e87d90ba1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Copy  of Create Record",
              "targetStep": "/api/3/workflow_steps/09b80f07-d280-4c93-b5ae-c1efec41968a",
              "sourceStep": "/api/3/workflow_steps/f61154f4-dade-4def-a0dc-164bc49e77c6",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "group": null,
              "uuid": "96be23a5-c644-4e9e-b7b5-cda762161b08"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Return Sample Data",
              "targetStep": "/api/3/workflow_steps/cf5e0ae5-356a-4739-80bb-925cc4c22107",
              "sourceStep": "/api/3/workflow_steps/f61154f4-dade-4def-a0dc-164bc49e77c6",
              "label": "Yes, For Mapping",
              "isExecuted": false,
              "group": null,
              "uuid": "b9429279-8d70-4014-ad9a-e95ba6a4fd1c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Resolve Range -> Is data only for mapping",
              "targetStep": "/api/3/workflow_steps/f61154f4-dade-4def-a0dc-164bc49e77c6",
              "sourceStep": "/api/3/workflow_steps/44c748fb-2384-44d3-ab55-8ffe9ff95efd",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "74c6daf5-4fdb-46fc-be77-dcb623ce4258"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/876bb39f-151e-4693-9ddc-11639433be3a",
              "sourceStep": "/api/3/workflow_steps/adbcfc33-d538-41d3-9db7-960eed0dc12b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "17cf0bcb-999f-421a-bd38-04cf138e9bdf"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "297c5ffb-5b53-422d-9f13-2379435cb076",
          "id": 599,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "fetch",
            "fortinet-fortiguard-threat-intelligence"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "FortiGuard Threat Intelligence > Ingest",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1664307357,
          "collection": "/api/3/workflow_collections/70d5e5ae-7ff3-4fe7-9c58-819afd457001",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8dc2f8a4-185c-4856-87db-0d31dde31788",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "fetchTime": "{{arrow.utcnow().int_timestamp}}",
                "pullTimeMacro": "FortiguardIntelligenceLastPullTime__{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "4fc11903-a9b9-479b-b18a-b8a10cac7f3c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Value from Response",
              "description": null,
              "arguments": {
                "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}{{arrow.utcnow().shift(days=-1).int_timestamp}}{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "4e6db073-7d3d-4f28-9444-3911bfc43066"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch and Create",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiGuard Threat Intelligence",
                "config": "7eba7ee9-9a69-4635-9eff-d613475f3e82",
                "params": {
                  "output_mode": "Create as Feed Records in FortiSOAR",
                  "create_pb_id": "010d4db5-5059-4c73-a7ea-f5f2a29ad2d0",
                  "modified_after": "{{vars.lastPullTime}}"
                },
                "version": "3.1.2",
                "connector": "fortinet-fortiguard-threat-intelligence",
                "operation": "ingest_feeds",
                "operationTitle": "Fetch Threat Intel Feeds",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "830e31fb-6e75-48c4-a524-7a4da3ece9db"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "2ec83581-5833-40f6-9609-a0dc31cdb6b3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "8dc2f8a4-185c-4856-87db-0d31dde31788"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.pullTimeMacro}}",
                  "value": "{{vars.fetchTime}}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "1cf1f2e1-f566-4029-bfa0-b2e81b4f5a4c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/2ec83581-5833-40f6-9609-a0dc31cdb6b3",
              "sourceStep": "/api/3/workflow_steps/4fc11903-a9b9-479b-b18a-b8a10cac7f3c",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "dcbba5cf-a815-44d0-8ff8-4d57240d8d15"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract Value from Response -> Fetch and Create",
              "targetStep": "/api/3/workflow_steps/830e31fb-6e75-48c4-a524-7a4da3ece9db",
              "sourceStep": "/api/3/workflow_steps/4e6db073-7d3d-4f28-9444-3911bfc43066",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "8e3b6285-73ca-47aa-8c42-e109558daf09"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch and Create -> Update Pull Time",
              "targetStep": "/api/3/workflow_steps/1cf1f2e1-f566-4029-bfa0-b2e81b4f5a4c",
              "sourceStep": "/api/3/workflow_steps/830e31fb-6e75-48c4-a524-7a4da3ece9db",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "96454756-5a3f-42c7-b6a4-b7eacb9791cb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Extract Value from Response",
              "targetStep": "/api/3/workflow_steps/4e6db073-7d3d-4f28-9444-3911bfc43066",
              "sourceStep": "/api/3/workflow_steps/2ec83581-5833-40f6-9609-a0dc31cdb6b3",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9761417b-a278-40d9-89c5-d667c8a2c3da"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/4fc11903-a9b9-479b-b18a-b8a10cac7f3c",
              "sourceStep": "/api/3/workflow_steps/8dc2f8a4-185c-4856-87db-0d31dde31788",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "00011780-3898-4a95-ad3c-ee434a0c7af3"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "2f93cd37-4a19-419a-b921-84319caca0e5",
          "id": 600,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "fortinet-fortiguard-threat-intelligence"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Fetch Threat Intel Feeds",
          "aliasName": null,
          "tag": "#Fortinet FortiGuard Threat Intelligence",
          "description": "Download the FortiGuard Threat Intel Feeds",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1694152959,
          "collection": "/api/3/workflow_collections/70d5e5ae-7ff3-4fe7-9c58-819afd457001",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/806724ca-a295-4d5e-8e31-94a0571a3dae",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Threat Intel Feeds",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiGuard Threat Intelligence",
                "config": "d168d1c5-1842-4e1a-ac52-4ba96432e481",
                "params": {
                  "output_mode": "Save to File",
                  "modified_after": ""
                },
                "version": "3.1.2",
                "connector": "fortinet-fortiguard-threat-intelligence",
                "operation": "ingest_feeds",
                "operationTitle": "Fetch Threat Intel Feeds",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "bc0892ad-5975-423b-9325-6c84eb432534"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "5d2fd477-465a-45df-86be-b7da373fce64",
                "title": "Fortinet FortiGuard Threat Intelligence: Fetch Threat Intel Feeds",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "806724ca-a295-4d5e-8e31-94a0571a3dae"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Fetch Threat Intel Feeds",
              "targetStep": "/api/3/workflow_steps/bc0892ad-5975-423b-9325-6c84eb432534",
              "sourceStep": "/api/3/workflow_steps/806724ca-a295-4d5e-8e31-94a0571a3dae",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0cedf899-58b4-4583-8ff5-f6d341ad2606"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "6bac6f45-69a9-4586-837b-7aa272936589",
          "id": 601,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortiguard-threat-intelligence"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Encyclopedia Lookup",
          "aliasName": null,
          "tag": "#Fortinet FortiGuard Threat Intelligence",
          "description": "Retrieves a lookup from FortiGuard Threat Intelligence based on the threat source and the associated encyclopedia lookup ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/70d5e5ae-7ff3-4fe7-9c58-819afd457001",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/9b5ffa4b-4839-41de-b1a4-27cb1808a3eb",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Encyclopedia Lookup",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiGuard Threat Intelligence",
                "config": "",
                "params": [],
                "version": "3.1.2",
                "connector": "fortinet-fortiguard-threat-intelligence",
                "operation": "get_encyclopedia_lookup",
                "operationTitle": "Get Encyclopedia Lookup",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "86190163-a558-481d-9f3e-ffd92d09e176"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "34f458d6-310e-4a21-bb2b-9c0c6303f6ba",
                "title": "Fortinet FortiGuard Threat Intelligence: Get Encyclopedia Lookup",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "9b5ffa4b-4839-41de-b1a4-27cb1808a3eb"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Encyclopedia Lookup",
              "targetStep": "/api/3/workflow_steps/86190163-a558-481d-9f3e-ffd92d09e176",
              "sourceStep": "/api/3/workflow_steps/9b5ffa4b-4839-41de-b1a4-27cb1808a3eb",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "3a3746d6-49f8-42c0-a432-c381dfad32b8"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "930b39de-c9e6-4536-a0c2-335b15a050d5",
          "id": 602,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortiguard-threat-intelligence"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "File Hash / Domain / IP / URL > Fortinet FortiGuard Threat Intelligence > Enrichment",
          "aliasName": null,
          "tag": null,
          "description": "Retrieve the reputation of indicator of type ‘File Hash / Domain / IP / URL’ using Fortinet FortiGuard Threat Intelligence.",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "indicator_value",
            "style_colors"
          ],
          "synchronous": false,
          "lastModifyDate": 1664307446,
          "collection": "/api/3/workflow_collections/70d5e5ae-7ff3-4fe7-9c58-819afd457001",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/9d765030-108a-454c-866d-7b9bd6f25fe3",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Fortinet FortiGuard Threat Intelligence Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<table class=\"no-border\">\n    <tr>\n        <th colspan=\"5\" class=\"no-background padding-0\">\n            <div class=\"font-size-11 ng-binding padding-bottom-sm\">\n                <h4 style=\"color: orange;\"\n                    class=\"body-default-bgcolor margin-bottom-0 padding-bottom-md padding-left-md padding-top-md text-align-left\">\n                    Fortinet FortiGuard Threat Intelligence Detection Summary</h4>\n            </div>\n        </th>\n    </tr>\n    <tr class=\"solid-border\">\n        <td>\n            <div small class=\"control-label\">Confidence</div>\n            <div class=\"card-container-body margin-left-0\" style=\"width: 100px;\">\n                <div>{% if vars.steps.Get_Reputation.data.confidence == vars.malicious_score %}</div>\n                <div class=\"body-default-bgcolor card-number padding-left-md\"\n                    style=\"border-left: 5px solid {{vars.input.params.style_colors.Malicious}};padding: 11px;font-size: 18px !important;\">\n                    {{vars.steps.Get_Reputation.data.confidence}}</div>\n                <div>{% elif vars.steps.Get_Reputation.data.confidence == vars.suspicious_score %}</div>\n                        <div class=\"body-default-bgcolor card-number padding-left-md\"\n                            style=\"border-left: 5px solid {{vars.input.params.style_colors.Suspicious}};padding: 11px;font-size: 18px !important;\">\n                            {{vars.steps.Get_Reputation.data.confidence}}</div>\n                        <div>{% elif vars.steps.Get_Reputation.data.confidence == vars.good_score %}</div>\n                        <div class=\"body-default-bgcolor card-number padding-left-md\"\n                            style=\"border-left: 5px solid {{vars.input.params.style_colors.Good}};padding: 11px;font-size: 18px !important;\">\n                            {{vars.steps.Get_Reputation.data.confidence}}</div>\n                        <div>{% else %}</div>\n                        <div class=\"body-default-bgcolor card-number padding-left-md\"\n                            style=\"border-left: 5px solid {{vars.input.params.style_colors['No Reputation Available']}};padding: 11px;font-size: 18px !important;\">\n                            {{vars.steps.Get_Reputation.data.confidence}}</div>\n                        <div>{% endif %}</div>\n                </div>\n        </td>\n        <td>\n            <div small class=\"control-label\">Web Filter Category</div>\n            <div class=\"card-container-body margin-left-0\" style=\"width: auto;\">\n                <div>{% if vars.steps.Get_Reputation.data.wf_cate %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">{{vars.steps.Get_Reputation.data.wf_cate}}</div>\n                <div>{% else %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">None</div>\n                <div>{% endif %}</div>\n            </div>\n        </td>\n        <td>\n            <div small class=\"control-label\">IOC Category</div>\n            <div class=\"card-container-body margin-left-0\" style=\"width: auto;\">\n                <div>{% if vars.steps.Get_Reputation.data.ioc_cate %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">{{vars.steps.Get_Reputation.data.ioc_cate}}</div>\n                <div>{% else %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">None</div>\n                <div>{% endif %}</div>\n            </div>\n        </td>\n        <td>\n            <div small class=\"control-label\">AV Category</div>\n            <div class=\"card-container-body margin-left-0\" style=\"width: auto;\">\n                <div>{% if vars.steps.Get_Reputation.data.av_cate %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">{{vars.steps.Get_Reputation.data.av_cate}}</div>\n                <div>{% else %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">None</div>\n                <div>{% endif %}</div>\n            </div>\n        </td>\n        <td>\n            <div small class=\"control-label\">IOC Tag</div>\n            <div class=\"card-container-body margin-left-0\" style=\"width: auto;\">\n                <div>{% if vars.steps.Get_Reputation.data.ioc_tags | length > 0 %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">{{vars.steps.Get_Reputation.data.ioc_tags[0]}}</div>\n                <div>{% else %}</div>\n                <div class=\"text-capitalize body-default-bgcolor card-number padding-left-md solid-border\"\n                    style=\"padding: 13px;border-left-width: 1px;border-left-color: #dcdcdc;font-size: 15px !important;\">None</div>\n                <div>{% endif %}</div>\n            </div>\n        </td>\n    </tr>\n</table>"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "83c0f506-e20a-46ee-9249-d161bedf1950"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "good_score": "Low",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "indicator_value": "{{vars.input.params['indicator_value']}}",
                "malicious_score": "High",
                "suspicious_score": "Medium",
                "enrichment_summary": "{}",
                "is_reputation_found": "false"
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "2d24dfc3-b45e-433b-859b-bd7bb461719a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Reputation",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiGuard Threat Intelligence",
                "config": "cf938ff4-e19b-460f-a0fa-fe8931dd7c1e",
                "params": {
                  "indicator": "{{vars.indicator_value}}"
                },
                "version": "3.1.2",
                "connector": "fortinet-fortiguard-threat-intelligence",
                "operation": "threat_intel_search",
                "mock_result": "{\n  \"data\": {\n    \"av_cate\": \"\",\n    \"wf_cate\": \"Phishing\",\n    \"ioc_cate\": \"\",\n    \"ioc_tags\": [],\n    \"confidence\": \"Low\",\n    \"spam_cates\": [],\n    \"reference_url\": \"https://ioc.fortiguard.com/search?query=weebly.com&filter=indicator\"\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null\n}",
                "ignore_errors": true,
                "operationTitle": "Threat Intel Search",
                "pickFromTenant": false,
                "step_variables": {
                  "is_reputation_found": "{% if vars.result.data.message != \"Information not found\" %}true{% else %}false{% endif %}"
                }
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "404ea711-518a-4669-b98e-3024a82a5819"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is IOC Found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Found",
                    "step_iri": "/api/3/workflow_steps/83c0f506-e20a-46ee-9249-d161bedf1950",
                    "condition": "{{ vars.is_reputation_found or vars.useMockOutput }}",
                    "step_name": "Compute Fortinet FortiGuard Threat Intelligence Summary"
                  },
                  {
                    "option": "Not Found",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/10fb62f3-9523-4f22-9b3f-e01f6f78d80a",
                    "step_name": "No Operation"
                  }
                ]
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "3ae9aaa0-a0c9-4069-93df-e76024b0311b"
            },
            {
              "@type": "WorkflowStep",
              "name": "No Operation",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "10fb62f3-9523-4f22-9b3f-e01f6f78d80a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Output Data",
              "description": null,
              "arguments": {
                "verdict": "{% if vars.steps.Get_Reputation.data.confidence == vars.malicious_score %}{{\"Malicious\"}}{% elif vars.steps.Get_Reputation.data.confidence == vars.suspicious_score %}{{\"Suspicious\"}}{% elif vars.steps.Get_Reputation.data.confidence == vars.good_score %}{{\"Good\"}}{% else %}{{\"No Reputation Available\"}}{% endif %}",
                "cti_name": "FortinetFortiGuardThreatIntelligence",
                "cti_score": "{{vars.steps.Get_Reputation.data.confidence }}",
                "source_data": "{\"FortinetFortiGuardThreatIntelligence\": {{vars.steps.Get_Reputation.data}} }",
                "enrichment_summary": "{{vars.steps.Compute_Fortinet_FortiGuard_Threat_Intelligence_Summary.data['formatted_string']}}"
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "2e49ebef-3684-4317-8b8e-d0de9f56f599"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "9d765030-108a-454c-866d-7b9bd6f25fe3"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute VT Summary -> Output Data",
              "targetStep": "/api/3/workflow_steps/2e49ebef-3684-4317-8b8e-d0de9f56f599",
              "sourceStep": "/api/3/workflow_steps/83c0f506-e20a-46ee-9249-d161bedf1950",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "29ec9601-b0ef-4dd3-a060-67c2a8cad245"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Reputation",
              "targetStep": "/api/3/workflow_steps/404ea711-518a-4669-b98e-3024a82a5819",
              "sourceStep": "/api/3/workflow_steps/2d24dfc3-b45e-433b-859b-bd7bb461719a",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "831cd517-7c11-4f02-b54e-c40fea7bb0f8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Reputation -> Is IOC Found",
              "targetStep": "/api/3/workflow_steps/3ae9aaa0-a0c9-4069-93df-e76024b0311b",
              "sourceStep": "/api/3/workflow_steps/404ea711-518a-4669-b98e-3024a82a5819",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d07b51e0-f26b-4e8d-9e3a-3e62a25c74be"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is IOC Found -> Compute Fortinet FortiGuard Threat Intelligence Summary",
              "targetStep": "/api/3/workflow_steps/83c0f506-e20a-46ee-9249-d161bedf1950",
              "sourceStep": "/api/3/workflow_steps/3ae9aaa0-a0c9-4069-93df-e76024b0311b",
              "label": "Found",
              "isExecuted": false,
              "group": null,
              "uuid": "e80888a8-5163-41bf-9f32-3327804bf658"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is IOC Found -> No Operation",
              "targetStep": "/api/3/workflow_steps/10fb62f3-9523-4f22-9b3f-e01f6f78d80a",
              "sourceStep": "/api/3/workflow_steps/3ae9aaa0-a0c9-4069-93df-e76024b0311b",
              "label": "Not Found",
              "isExecuted": false,
              "group": null,
              "uuid": "eeced108-6955-4de5-872b-220ea836ccbf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/2d24dfc3-b45e-433b-859b-bd7bb461719a",
              "sourceStep": "/api/3/workflow_steps/9d765030-108a-454c-866d-7b9bd6f25fe3",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0cdd5475-1b29-4b74-a6c6-8832f63b03bd"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "b1a57e00-ce21-42e4-9ca3-e60a34237974",
          "id": 603,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Subroutine",
            "IP_Enrichment",
            "URL_Enrichment",
            "Domain_Enrichment",
            "FileHash_Enrichment"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Threat Categories",
          "aliasName": null,
          "tag": "#Fortinet FortiGuard Threat Intelligence",
          "description": "Retrieves a static list of threat types and names from FortiGuard Threat Intelligence based on the title that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1694152969,
          "collection": "/api/3/workflow_collections/70d5e5ae-7ff3-4fe7-9c58-819afd457001",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e0855c42-a680-450f-8a92-d348decb2548",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Threat Categories",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiGuard Threat Intelligence",
                "config": "d168d1c5-1842-4e1a-ac52-4ba96432e481",
                "params": [],
                "version": "3.1.2",
                "connector": "fortinet-fortiguard-threat-intelligence",
                "operation": "get_threat_categories",
                "operationTitle": "Get Threat Categories",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f4d5e911-285d-402c-88fd-3ee4455b023e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "2a0935cd-9f29-4def-9c4f-66e4d7e77c7e",
                "title": "Fortinet FortiGuard Threat Intelligence: Get Threat Categories",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "e0855c42-a680-450f-8a92-d348decb2548"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Threat Categories",
              "targetStep": "/api/3/workflow_steps/f4d5e911-285d-402c-88fd-3ee4455b023e",
              "sourceStep": "/api/3/workflow_steps/e0855c42-a680-450f-8a92-d348decb2548",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1a175f54-3739-41ee-9314-40c184bf4362"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "b947b5d9-1885-4674-a7bb-ceb2f3dbbae9",
          "id": 604,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortiguard-threat-intelligence"
          ]
        }
      ]
    }
  ],
  "macros": [
    {
      "name": "Demo_mode",
      "value": "false",
      "default_value": "false"
    }
  ],
  "exported_tags": [
    "Fortinet",
    "fortinet-fortiguard-threat-intelligence",
    "dataingestion",
    "create",
    "fetch",
    "ingest",
    "Subroutine",
    "IP_Enrichment",
    "URL_Enrichment",
    "Domain_Enrichment",
    "FileHash_Enrichment"
  ]
}