{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Fortinet FortiRecon ACI - 1.1.0",
      "description": "FortiRecon is a Digital Risk Protection Service (DRPS) product that provides an outside-the-network view to the risks posed to your enterprise.The Adversary Centric Intelligence (ACI) module leverages FortiGuard Threat Analysts to provide comprehensive coverage of dark web, open source, and technical threat intelligence, including threat actor insights. This information enables administrators to proactively assess risks, respond faster to incidents, better understand their attackers, and protect assets. This connector facilitates the automated operations related to ACI",
      "visible": true,
      "image": null,
      "uuid": "7a145247-0a97-4b39-9902-8bd8e0be0e43",
      "id": 47,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "Fortinet",
        "fortinet-fortirecon-aci"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Reports With IOCs",
          "aliasName": null,
          "tag": "#Fortinet FortiRecon ACI",
          "description": "Retrieves details, including IOCs, for a specific report for the given organization ID and the report ID you have specified from Fortinet FortiRecon ACI.\nThe data returned by this operation contains a list of all the filtered reports with title, summary, report URL, IOCs, and the metadata related to the reports.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1684134427,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e8b2aa71-8467-4ee1-ac4d-dbcf88eba0d9",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Reports With IOCs",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "1bb114d2-8376-4b77-b1c0-c9fc93a229c1",
                "params": {
                  "id": "2022120253669"
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_reports_with_iocs",
                "operationTitle": "Get Reports With IOCs",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "160",
              "left": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "51090f8f-afd2-48dd-92eb-0201f2eb9b7f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "9adbeaa2-a2f7-487a-90fe-358d80b98626",
                "title": "Fortinet FortiRecon ACI: Get Reports With IOCs",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "e8b2aa71-8467-4ee1-ac4d-dbcf88eba0d9"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Reports With IOCs",
              "targetStep": "/api/3/workflow_steps/51090f8f-afd2-48dd-92eb-0201f2eb9b7f",
              "sourceStep": "/api/3/workflow_steps/e8b2aa71-8467-4ee1-ac4d-dbcf88eba0d9",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f0ad604e-5e1f-4459-9b96-f067382a1a33"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "1e8f9fad-9f20-4bcc-a9d9-5655abcecbde",
          "id": 482,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get FortiRecon ACI Threat Intel Report IOC",
          "aliasName": null,
          "tag": null,
          "description": "Fetch the associated ioc for specified FortiRecon ACI threat intel report",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "report_details",
            "page_size"
          ],
          "synchronous": false,
          "lastModifyDate": 1686119431,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/c6f1d435-6b8a-4390-b8e9-1559a3056918",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "page_size": "{{vars.input.params['page_size']}}",
                "technical_intelligence_report_iocs": "[]"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "d6ad5a21-92e6-4311-9701-20bbc9df7c4e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch IOC",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "0739e555-96c6-46f6-8a39-25066be858c5",
                "params": {
                  "page": "{{vars.item}}",
                  "size": "{{vars.page_size}}",
                  "end_date": "",
                  "ioc_type": "",
                  "report_id": "{{vars.input.params['report_details'].report_id}}",
                  "start_date": ""
                },
                "version": "1.1.0",
                "for_each": {
                  "item": "{{range(2,((vars.page_numbers | int)+1)) | list}}",
                  "parallel": false,
                  "condition": ""
                },
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_iocs",
                "operationTitle": "Get IOCs",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "71985ecc-dd22-40ed-a674-6032b5501284"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get All Technical Intelligence Report IOCs",
              "description": null,
              "arguments": {
                "_tmp": "{% for item in vars.steps.Get_IOC.data.hits %}{% set _ = vars.technical_intelligence_report_iocs.append(item) %}{% endfor %}\n{% for item in vars.steps.Fetch_IOC %}{% for i in item.data.hits %}{% set _ = vars.technical_intelligence_report_iocs.append(i) %}{% endfor %}{% endfor %}"
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "5960529b-d91f-46f2-92bc-5560933a14d8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get IOC",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "0739e555-96c6-46f6-8a39-25066be858c5",
                "params": {
                  "page": "",
                  "size": "{{vars.page_size}}",
                  "end_date": "",
                  "ioc_type": "",
                  "report_id": "{{vars.input.params['report_details'].report_id}}",
                  "start_date": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_iocs",
                "operationTitle": "Get IOCs",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "b1de0fe1-e1f3-4ac9-996c-1944cede72ea"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Total Number Pages",
              "description": null,
              "arguments": {
                "page_numbers": "{{(vars.steps.Get_IOC.data.total / vars.steps.Get_IOC.data.size ) | round(0, 'ceil')}}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "702a0b96-364e-4567-95d6-1c9bb45e76a6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Report and Associated IOCs",
              "description": null,
              "arguments": {
                "report_iocs": "{{vars.technical_intelligence_report_iocs}}",
                "report_details": "{{vars.input.params['report_details']}}"
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "50103215-53fb-451a-924a-cf4699459b90"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "c6f1d435-6b8a-4390-b8e9-1559a3056918"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get IOCs",
              "targetStep": "/api/3/workflow_steps/b1de0fe1-e1f3-4ac9-996c-1944cede72ea",
              "sourceStep": "/api/3/workflow_steps/d6ad5a21-92e6-4311-9701-20bbc9df7c4e",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a0963011-28f7-459d-a45c-6afe1e8932ec"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch IOCs -> Get All Technical Intelligence Reports",
              "targetStep": "/api/3/workflow_steps/5960529b-d91f-46f2-92bc-5560933a14d8",
              "sourceStep": "/api/3/workflow_steps/71985ecc-dd22-40ed-a674-6032b5501284",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "9d1e835c-078e-42b3-b0a0-a9b706255687"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get All Technical Intelligence Report IOCs -> Return IOCc",
              "targetStep": "/api/3/workflow_steps/50103215-53fb-451a-924a-cf4699459b90",
              "sourceStep": "/api/3/workflow_steps/5960529b-d91f-46f2-92bc-5560933a14d8",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "2bad25a5-a11a-4772-a8dd-f603258a7b62"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get IOCs -> Get Total Number Pages",
              "targetStep": "/api/3/workflow_steps/702a0b96-364e-4567-95d6-1c9bb45e76a6",
              "sourceStep": "/api/3/workflow_steps/b1de0fe1-e1f3-4ac9-996c-1944cede72ea",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "4836a645-a729-4ff3-b508-16cd78719782"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Total Number Pages -> Copy of Get IOCs",
              "targetStep": "/api/3/workflow_steps/71985ecc-dd22-40ed-a674-6032b5501284",
              "sourceStep": "/api/3/workflow_steps/702a0b96-364e-4567-95d6-1c9bb45e76a6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "bce8a111-0f82-429b-97a3-d766eef5dd0a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/d6ad5a21-92e6-4311-9701-20bbc9df7c4e",
              "sourceStep": "/api/3/workflow_steps/c6f1d435-6b8a-4390-b8e9-1559a3056918",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0574cf6e-c4dd-4686-bfd0-98686ceb9358"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "306c9cac-f35c-44a5-94c4-b6639f26c979",
          "id": 855,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Widgets",
          "aliasName": null,
          "tag": "#Fortinet FortiRecon ACI",
          "description": "Retrieves a list of all widgets or specific widgets for the given organization ID and other input parameters you have specified from Fortinet FortiRecon ACI.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1679902101,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/c49b4d94-445d-4c89-9534-79fa73099ac3",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Widgets",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "''",
                "params": {
                  "page": "",
                  "size": 10
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_widgets",
                "operationTitle": "Get Widgets",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "b3ab0982-649e-4304-b70f-8ff1f3aea561"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ca0ce105-a33e-483c-bdb8-3be728551947",
                "title": "Fortinet FortiRecon ACI: Get Widgets",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "c49b4d94-445d-4c89-9534-79fa73099ac3"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Widgets",
              "targetStep": "/api/3/workflow_steps/b3ab0982-649e-4304-b70f-8ff1f3aea561",
              "sourceStep": "/api/3/workflow_steps/c49b4d94-445d-4c89-9534-79fa73099ac3",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "04c8fefc-004b-4875-9cda-120f6bc1383f"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "4468fb11-9f8d-48b9-814c-6e23625157ff",
          "id": 483,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "On Create > Map Adversary to MITRE Groups/Techniques/Softwares",
          "aliasName": null,
          "tag": null,
          "description": "Map adversary to MITRE Groups/Techniques/Softwares on create of threat report",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686119431,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/39a3385c-07dd-4c39-a223-28b45016d4a5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Map Adversary to MITRE Records",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "/api/3/workflows/a89c4164-2099-4bac-a0f7-be58a435ae26"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "73ff4282-7e37-43a1-8a6c-b226c13271e6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "threat_intel_reports",
                "resources": [
                  "threat_intel_reports"
                ],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": []
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "group": null,
              "uuid": "39a3385c-07dd-4c39-a223-28b45016d4a5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Map Adversary to MITRE Records",
              "targetStep": "/api/3/workflow_steps/73ff4282-7e37-43a1-8a6c-b226c13271e6",
              "sourceStep": "/api/3/workflow_steps/39a3385c-07dd-4c39-a223-28b45016d4a5",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7f37fbd1-6aa5-42c1-8e0d-b8d794760a5c"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "61c28e6a-f509-4501-9743-d8a774284a9c",
          "id": 858,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "FortiSOAR Threat Intel Feeds Using Threat Intel Report > Create",
          "aliasName": null,
          "tag": null,
          "description": "Create threat intel reports and it's associated ioc as FortiSOAR threat intel feeds",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "report_iocs",
            "report_details"
          ],
          "synchronous": false,
          "lastModifyDate": 1686119431,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b7ddf75b-fee9-4225-9ee6-1e513da4106a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "resource": {
                  "tLP": "{{vars.report_details.tlp | resolveRange(vars.tlp_type_map)}}",
                  "__link": {
                    "recordTags": "{{vars.threat_tags}}"
                  },
                  "source": "FortiRecon ACI Report",
                  "status": "{{vars.report_details.status}}",
                  "threat": "{{vars.report_details.threat}}",
                  "summary": "<p>{{vars.report_details.summary}}</p>",
                  "reportID": "{{vars.report_details.report_id}}",
                  "__replace": "false",
                  "adversary": "{{vars.report_details.adversary}}",
                  "geography": "{{vars.report_details.geography}}",
                  "motivation": "{{vars.report_details.motivation}}",
                  "reportLink": "https://fortirecon.forticloud.com/adversary-centric-intelligence/reports?reportId={{vars.report_details.report_id}}",
                  "reportType": "{{vars.report_details.report_type | resolveRange(vars.report_type_map)}}",
                  "sourceData": "{{vars.report_details}}",
                  "sourceName": "{{vars.report_details.source_name}}",
                  "publishDate": "{{ arrow.get(vars.report_details.publish_date, 'YYYY-MM-DDTHH:mm:ssZ').int_timestamp }}",
                  "reportTitle": "{{vars.report_details.report_title}}",
                  "industryTags": "{{vars.report_details.industry_tags}}",
                  "sourceCategory": "{{vars.report_details.source_category | resolveRange(vars.source_category_type_map)}}",
                  "informationDate": "{{ arrow.get(vars.report_details.information_date, 'YYYY-MM-DDTHH:mm:ssZ').int_timestamp }}",
                  "relevanceRating": "{{vars.report_details.relevance_rating | resolveRange(vars.relevance_rating_type_map)}}",
                  "sourceReliability": "{{vars.report_details.source_reliability | resolveRange(vars.source_reliability_type_map)}}",
                  "informationReliability": "{{vars.report_details.information_reliability | resolveRange(vars.information_reliability_type_map)}}"
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/threat_intel_reports",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "36157b27-1cc8-4742-bb5d-7398d4fdc130"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Threat Intel Feed",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.input.params['report_iocs']}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "{{vars.item.ioc_type not in [\"adversary\", \"cve\"]}}",
                  "batch_size": 100
                },
                "resource": {
                  "tLP": "{{vars.report_details.tlp | resolveRange(vars.tlp_type_map)}}",
                  "value": "{{vars.item.ioc}}",
                  "__link": {
                    "recordTags": "{{vars.threat_tags}}",
                    "threatIntelReports": "[\"{{vars.steps.Create_Record['@id']}}\"]"
                  },
                  "source": "FortiRecon ACI Report",
                  "sourceId": "{{vars.report_details.report_id}}",
                  "__replace": "true",
                  "confidence": 100,
                  "reputation": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                  "sourceData": "{{vars.item}}",
                  "typeOfFeed": "{{vars.item.ioc_type | resolveRange(vars.threat_intel_feed_type_map)}}",
                  "description": "<p>{{vars.report_details.report_title}}</p>"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "/api/3/upsert/threat_intel_feeds",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Append",
                  "threatTypes": "Overwrite",
                  "killChainPhases": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "1ee20da7-71ba-40ae-9f9d-d2f9f93f26aa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Field Mapping",
              "description": null,
              "arguments": {
                "threat_tags": "[]",
                "tlp_type_map": "{\n  \t\"White\": \"{{\"TrafficLightProtocol\" | picklist(\"White\")}}\",\n  \t\"Green\": \"{{\"TrafficLightProtocol\" | picklist(\"Green\")}}\",\n  \t\"Amber\": \"{{\"TrafficLightProtocol\" | picklist(\"Amber\")}}\",\n  \t\"Red\": \"{{\"TrafficLightProtocol\" | picklist(\"Red\")}}\"\n}",
                "report_type_map": "{\n\"Flash Report\": \"{{\"Report Type\" | picklist(\"Flash Report\")}}\",\n\"Flash Alert\": \"{{\"Report Type\" | picklist(\"Flash Alert\")}}\",\n\"Threat Report\": \"{{\"Report Type\" | picklist(\"Threat Report\")}}\",\n\"Threat Alert\": \"{{\"Report Type\" | picklist(\"Threat Alert\")}}\"\n}",
                "source_category_type_map": "{\n\t\"Media Trends\": \"{{\"Source Category\" | picklist(\"Media Trends\")}}\",\n\t\"Darknet\": \"{{\"Source Category\" | picklist(\"Darknet\")}}\",\n\t\"Humint\": \"{{\"Source Category\" | picklist(\"Humint\")}}\",\n\t\"OSINT\": \"{{\"Source Category\" | picklist(\"OSINT\")}}\",\n\t\"Fraudulent Domains\": \"{{\"Source Category\" | picklist(\"Fraudulent Domains\")}}\",\n\t\"Technical Intelligence\": \"{{\"Source Category\" | picklist(\"Technical Intelligence\")}}\",\n\t\"Executive Summary\": \"{{\"Source Category\" | picklist(\"Executive Summary\")}}\"\n}",
                "relevance_rating_type_map": "{\n\t\"High\": \"{{\"Relevance Rating\" | picklist(\"High\")}}\",\n\t\"Medium\": \"{{\"Relevance Rating\" | picklist(\"Medium\")}}\",\n\t\"Low\": \"{{\"Relevance Rating\" | picklist(\"Low\")}}\"\n}",
                "threat_intel_feed_type_map": "{\n\"hash\": \"{{\"ThreatIntelFeedType\" | picklist(\"FileHash\")}}\",\n\"url\": \"{{\"ThreatIntelFeedType\" | picklist(\"URL\")}}\",\n\"ip\": \"{{\"ThreatIntelFeedType\" | picklist(\"IP Address\")}}\",\n\"file_name, file_path\": \"{{\"ThreatIntelFeedType\" | picklist(\"Filename\")}}\",\n\"DOMAIN, domain\": \"{{\"ThreatIntelFeedType\" | picklist(\"Domain\")}}\",\n\"email\": \"{{\"ThreatIntelFeedType\" | picklist(\"Email Address\")}}\",\n\"registry_key\": \"{{\"ThreatIntelFeedType\" | picklist(\"Registry\")}}\"\n}",
                "source_reliability_type_map": "{\n  \t\"A-Reliable\": \"{{\"Source Reliability\" | picklist(\"Reliable\")}}\",\n  \t\"B-Usually reliable\": \"{{\"Source Reliability\" | picklist(\"Usually Reliable\")}}\",\n  \t\"C-Fairly reliable\": \"{{\"Source Reliability\" | picklist(\"Fairly Reliable\")}}\",\n  \t\"D-Not usually reliable\": \"{{\"Source Reliability\" | picklist(\"Not Usually Reliable\")}}\",\n  \t\"E-Unreliable\": \"{{\"Source Reliability\" | picklist(\"Unreliable\")}}\",\n  \t\"F-Cannot be judged\": \"{{\"Source Reliability\" | picklist(\"Cannot Judged\")}}\"\n}",
                "information_reliability_type_map": "{\n\t\"1-Confirmed\": \"{{\"Information Reliability\" | picklist(\"Confirmed\")}}\",\n\t\"2-Probably true\": \"{{\"Information Reliability\" | picklist(\"Probably True\")}}\",\n\t\"3-Possibly true\": \"{{\"Information Reliability\" | picklist(\"Possibly True\")}}\",\n\t\"4-Doubtfully true\": \"{{\"Information Reliability\" | picklist(\"Doubtfully True\")}}\",\n\t\"5-Improbable\": \"{{\"Information Reliability\" | picklist(\"Improbable\")}}\",\n\t\"6-Cannot be judged\": \"{{\"Information Reliability\" | picklist(\"Cannot Judged\")}}\"\n}"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "0b4ce355-f751-4804-89e0-7a350ed9f3b6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Threat Tags",
              "description": null,
              "arguments": {
                "__tmp": "{% set excludeList = [\"(not known)\", \"n/a\", \"unknown\", \"others\", \"N/A\" ] %}\n{% for tag in vars.report_details.threat %}\n{% if tag not in excludeList %}\n{% set _temp=vars.threat_tags.append((tag.replace(\"/\",\"-\")).replace(\"#\",\"\")) %}\n{% endif %}\n{% endfor %}\n{% for tag in vars.report_details.industry_tags %}\n{% if tag not in excludeList %}\n{% set _temp=vars.threat_tags.append(tag.replace(\"/\",\"-\")) %}\n{% endif %}\n{% endfor %}\n{% for tag in vars.report_details.adversary %}\n{% if tag not in excludeList %}\n{% set _temp=vars.threat_tags.append(tag.replace(\"/\",\"-\")) %}\n{% endif %}\n{% endfor %}\n{% for tag in vars.report_details.geography %}\n{% if tag not in excludeList %}\n{% set _temp=vars.threat_tags.append(tag.replace(\"/\",\"-\")) %}\n{% endif %}\n{% endfor %}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "852d3341-7a91-4c4a-9462-a10195cfbe81"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "b7ddf75b-fee9-4225-9ee6-1e513da4106a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create ACI Report -> Create Threat Intel Feeds",
              "targetStep": "/api/3/workflow_steps/1ee20da7-71ba-40ae-9f9d-d2f9f93f26aa",
              "sourceStep": "/api/3/workflow_steps/36157b27-1cc8-4742-bb5d-7398d4fdc130",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0308b03a-78db-4bec-a8c8-ca828c64a280"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Field Mapping -> Get Miter Group and Threat Tags",
              "targetStep": "/api/3/workflow_steps/852d3341-7a91-4c4a-9462-a10195cfbe81",
              "sourceStep": "/api/3/workflow_steps/0b4ce355-f751-4804-89e0-7a350ed9f3b6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f34e2d99-c769-4afd-9e94-486b27c95905"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Miter Group and Threat Tags -> Create Record",
              "targetStep": "/api/3/workflow_steps/36157b27-1cc8-4742-bb5d-7398d4fdc130",
              "sourceStep": "/api/3/workflow_steps/852d3341-7a91-4c4a-9462-a10195cfbe81",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "93e1e7a7-5e01-470d-839b-db0b1732f10d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Field Mapping",
              "targetStep": "/api/3/workflow_steps/0b4ce355-f751-4804-89e0-7a350ed9f3b6",
              "sourceStep": "/api/3/workflow_steps/b7ddf75b-fee9-4225-9ee6-1e513da4106a",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "1a595a8b-9965-4a4a-b4ae-f0fba27c44e0"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "6b0b6ffd-cd3d-4f14-bc00-8ed74f83c86b",
          "id": 853,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "FortiRecon ACI Threat Intel Report > Fetch",
          "aliasName": null,
          "tag": null,
          "description": "Fetch FortiRecon ACI Threat Intel Report and associated iocs",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686574106,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6b92edb8-103d-459d-823f-82c441a29878",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "fetchTime": "{{arrow.utcnow().int_timestamp}}",
                "page_size": 500,
                "pullTimeMacro": "FortiReconACILastPullTime__{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}",
                "source_category": "Technical Intelligence",
                "last_sample_pull_time": "24",
                "technical_intelligence_reports": "[]"
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "1df01a2e-c886-4cb7-b054-c1a14d5b6fb0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Threat Intel Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Report_IOCs}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "report_iocs": "{{vars.item.report_iocs}}",
                  "report_details": "{{vars.item.report_details}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "/api/3/workflows/6b0b6ffd-cd3d-4f14-bc00-8ed74f83c86b"
              },
              "status": null,
              "top": "1380",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "e9719ee4-ec03-47a2-9494-5a2c5fcb8f21"
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Response Value",
              "description": null,
              "arguments": {
                "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}{{arrow.utcnow().shift(hours= -vars.last_sample_pull_time).int_timestamp}}{% endif %}"
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "cca48f6b-83ba-480b-83a9-80e1c8e5620e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Sample Reports",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "0739e555-96c6-46f6-8a39-25066be858c5",
                "params": {
                  "page": "",
                  "size": "5",
                  "tags": "",
                  "keyword": "",
                  "end_date": "{{arrow.get(vars.fetchTime).format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z",
                  "industry": "",
                  "adversary": "",
                  "geography": "",
                  "start_date": "{{arrow.get(vars.lastPullTime).format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z",
                  "report_type": "",
                  "source_category": "{{vars.source_category}}",
                  "relevance_rating": "",
                  "source_reliability": "",
                  "information_reliability": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_reports",
                "operationTitle": "Get Reports",
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "fef5ea01-e946-4097-b1f9-2a0edddc63f6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Technical Intelligence Reports",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "0739e555-96c6-46f6-8a39-25066be858c5",
                "params": {
                  "page": "{{vars.item}}",
                  "size": "{{vars.page_size}}",
                  "tags": "",
                  "keyword": "",
                  "end_date": "{{arrow.get(vars.fetchTime).format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z",
                  "industry": "",
                  "adversary": "",
                  "geography": "",
                  "start_date": "{{arrow.get(vars.lastPullTime).format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z",
                  "report_type": "",
                  "source_category": "{{vars.source_category}}",
                  "relevance_rating": "",
                  "source_reliability": "",
                  "information_reliability": ""
                },
                "version": "1.1.0",
                "for_each": {
                  "item": "{{range(2,((vars.page_numbers | int)+1)) | list}}",
                  "parallel": false,
                  "condition": ""
                },
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_reports",
                "operationTitle": "Get Reports",
                "step_variables": []
              },
              "status": null,
              "top": "975",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "ee2df618-db89-43f8-97fa-268c3e2105eb"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get All Technical Intelligence Reports",
              "description": null,
              "arguments": {
                "_tmp": "{% for item in  vars.steps.Get_Technical_Intelligence_Reports.data.hits %}{% set _ = vars.technical_intelligence_reports.append(item) %}{% endfor %}\n{% for item in vars.steps.Fetch_Technical_Intelligence_Reports %}{% for i in item.data.hits %}{% set _ = vars.technical_intelligence_reports.append(i) %}{% endfor %}{% endfor %}"
              },
              "status": null,
              "top": "1110",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "fad9b59a-4fac-4459-9b51-da4e5cec0439"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "1f2dc0e7-6413-426c-b00a-7ff3e3b449ed"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Report IOCs",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.technical_intelligence_reports}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "page_size": "{{vars.page_size}}",
                  "report_details": "{{vars.item}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "/api/3/workflows/306c9cac-f35c-44a5-94c4-b6639f26c979"
              },
              "status": null,
              "top": "1245",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "525998b7-bf3d-45ba-a090-361d8760c3e3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Technical Intelligence Reports",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "0739e555-96c6-46f6-8a39-25066be858c5",
                "params": {
                  "page": "",
                  "size": "{{vars.page_size}}",
                  "tags": "",
                  "keyword": "",
                  "end_date": "{{arrow.get(vars.fetchTime).format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z",
                  "industry": "",
                  "adversary": "",
                  "geography": "",
                  "start_date": "{{arrow.get(vars.lastPullTime).format('YYYY-MM-DDTHH:mm:ss.SSS')}}Z",
                  "report_type": "",
                  "source_category": "{{vars.source_category}}",
                  "relevance_rating": "",
                  "source_reliability": "",
                  "information_reliability": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_reports",
                "operationTitle": "Get Reports",
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "02b10879-c0a6-48ef-864c-6e9513e84b73"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Total Number Pages",
              "description": null,
              "arguments": {
                "page_numbers": "{{(vars.steps.Get_Technical_Intelligence_Reports.data.total / vars.steps.Get_Technical_Intelligence_Reports.data.size ) | round(0, 'ceil')}}"
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8b03c823-d65c-4a3b-bcc9-e6e634482ec7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Data Mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, For Mapping",
                    "step_iri": "/api/3/workflow_steps/fef5ea01-e946-4097-b1f9-2a0edddc63f6",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Copy of Get Technical Intelligence Reports"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/02b10879-c0a6-48ef-864c-6e9513e84b73",
                    "step_name": "Get Technical Intelligence Reports"
                  }
                ]
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "1676d62a-8627-402e-8731-76807d3d4510"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Sample Reports",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Fetch_Sample_Reports.data.hits}}"
              },
              "status": null,
              "top": "840",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "d4569fa9-7a34-413f-8378-3c94aff3b873"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\": \"Pull Reports from Last X Hours\",\n    \"name\": \"last_sample_pull_time\",\n    \"type\": \"text\",\n    \"tooltip\": \"Fetch reports from last X hours. e.g 24\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 24\n  },\n  {\n    \"name\": \"source_category\",\n    \"title\": \"Source Category\",\n    \"type\": \"text\",\n    \"editable\": true,\n    \"visible\": true,\n    \"required\": false,\n    \"value\": \"Technical Intelligence\",\n    \"placeholder\": \"Only \\\"Technical Intelligence\\\" type \\\"Source Category\\\" is supported\",\n    \"tooltip\": \"Only \\\"Technical Intelligence\\\" type \\\"Source Category\\\" is supported\"\n  },\n  {\n    \"name\": \"page_size\",\n    \"title\": \"Page Size\",\n    \"type\": \"integer\",\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 500,\n    \"required\": false,\n    \"placeholder\": \"Must be greater 0 and less than or equal to 500.\",\n    \"tooltip\": \"Specify the maximum number of records that this operation should return for the specified page. By default, it retrieves 10 records.\"\n  }\n]"
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "6b92edb8-103d-459d-823f-82c441a29878"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.pullTimeMacro}}",
                  "value": "{{vars.fetchTime}}"
                },
                "version": "3.2.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "1515",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "3ffdaa23-a7e4-4a08-b1f0-ba53d8f1d4b7"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/1f2dc0e7-6413-426c-b00a-7ff3e3b449ed",
              "sourceStep": "/api/3/workflow_steps/1df01a2e-c886-4cb7-b054-c1a14d5b6fb0",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7d959c5a-542b-4c47-a64e-034e408ef429"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Threat Intel Record -> Update Pull Time",
              "targetStep": "/api/3/workflow_steps/3ffdaa23-a7e4-4a08-b1f0-ba53d8f1d4b7",
              "sourceStep": "/api/3/workflow_steps/e9719ee4-ec03-47a2-9494-5a2c5fcb8f21",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7a36cf5a-08a1-48f7-9a87-0100a122c9a6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract Value from Response -> Is Data Mapping",
              "targetStep": "/api/3/workflow_steps/1676d62a-8627-402e-8731-76807d3d4510",
              "sourceStep": "/api/3/workflow_steps/cca48f6b-83ba-480b-83a9-80e1c8e5620e",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "11c6e0af-a974-4d5d-ac6d-7d24c84dcd9d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Sample Reports -> Return Sample Reports",
              "targetStep": "/api/3/workflow_steps/d4569fa9-7a34-413f-8378-3c94aff3b873",
              "sourceStep": "/api/3/workflow_steps/fef5ea01-e946-4097-b1f9-2a0edddc63f6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "6fef3e6f-4ab5-4786-a549-c57a596477d1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Technical Intelligence Reports -> Get All Technical Intelligence Reports",
              "targetStep": "/api/3/workflow_steps/fad9b59a-4fac-4459-9b51-da4e5cec0439",
              "sourceStep": "/api/3/workflow_steps/ee2df618-db89-43f8-97fa-268c3e2105eb",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ed3d6c4f-342e-45c8-a54e-9f943bca4342"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get All Technical Intelligence Reports -> Get Report IOCs",
              "targetStep": "/api/3/workflow_steps/525998b7-bf3d-45ba-a090-361d8760c3e3",
              "sourceStep": "/api/3/workflow_steps/fad9b59a-4fac-4459-9b51-da4e5cec0439",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "3155d44f-8658-444e-b834-5e7da1a26d63"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Extract Value from Response",
              "targetStep": "/api/3/workflow_steps/cca48f6b-83ba-480b-83a9-80e1c8e5620e",
              "sourceStep": "/api/3/workflow_steps/1f2dc0e7-6413-426c-b00a-7ff3e3b449ed",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ce559ef9-49e1-443e-8c0f-b201ecb62049"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Report IOCs -> Create Threat Intel Record",
              "targetStep": "/api/3/workflow_steps/e9719ee4-ec03-47a2-9494-5a2c5fcb8f21",
              "sourceStep": "/api/3/workflow_steps/525998b7-bf3d-45ba-a090-361d8760c3e3",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "429ad869-7e5d-459f-bfbd-48f68dc8042f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Technical Intelligence Reports -> Get Total Number Pages",
              "targetStep": "/api/3/workflow_steps/8b03c823-d65c-4a3b-bcc9-e6e634482ec7",
              "sourceStep": "/api/3/workflow_steps/02b10879-c0a6-48ef-864c-6e9513e84b73",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "887ca113-3aab-4e67-9c25-09daa5ed096f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Total Number Pages -> Fetch Technical Intelligence Reports",
              "targetStep": "/api/3/workflow_steps/ee2df618-db89-43f8-97fa-268c3e2105eb",
              "sourceStep": "/api/3/workflow_steps/8b03c823-d65c-4a3b-bcc9-e6e634482ec7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b50235ee-a9cf-4855-8602-51d8f7ba92f1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Data Mapping -> Copy of Get Technical Intelligence Reports",
              "targetStep": "/api/3/workflow_steps/fef5ea01-e946-4097-b1f9-2a0edddc63f6",
              "sourceStep": "/api/3/workflow_steps/1676d62a-8627-402e-8731-76807d3d4510",
              "label": "Yes, For Mapping",
              "isExecuted": false,
              "group": null,
              "uuid": "5d603407-f66d-4b0d-a496-f2187f25ecaa"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Data Mapping -> Get Technical Intelligence Reports",
              "targetStep": "/api/3/workflow_steps/02b10879-c0a6-48ef-864c-6e9513e84b73",
              "sourceStep": "/api/3/workflow_steps/1676d62a-8627-402e-8731-76807d3d4510",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "group": null,
              "uuid": "893b0477-b7f5-4b06-b6be-712ae426245e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/1df01a2e-c886-4cb7-b054-c1a14d5b6fb0",
              "sourceStep": "/api/3/workflow_steps/6b92edb8-103d-459d-823f-82c441a29878",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a94e5821-0bb7-43f9-b84c-e6c49a66cd70"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "7000c723-654b-4d71-9e95-4cdda2ecf5fd",
          "id": 854,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "fetch",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Map Adversary to MITRE Groups/Techniques/Softwares",
          "aliasName": null,
          "tag": null,
          "description": "Map threat report adversary to MITRE Groups/Techniques/Softwares",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686119431,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/380396ce-14b0-4c44-82bb-ca2b83db30ae",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "software": "[]",
                "groups_iri": "[]",
                "techniques": "[]"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "7bed58c0-d5e3-460c-9587-c646d5d05f20"
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Adversary in MITRE Associated Groups",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/query/mitre_groups?$limit=300$relationships=true",
                  "body": "{\n  \"sort\": [],\n  \"limit\": 30,\n  \"logic\": \"AND\",\n  \"filters\": [\n    {\n      \"field\": \"aliases\",\n      \"operator\": \"like\",\n      \"_operator\": \"like\",\n      \"value\": \"{{vars.item}}%\",\n      \"type\": \"primitive\"\n    }\n  ],\n  \"__selectFields\": [\n    \"aliases\",\n    \"@id\",\n    \"software\",\n    \"techniques\"\n  ]\n}",
                  "method": "POST"
                },
                "version": "3.2.3",
                "for_each": {
                  "item": "{{vars.input.records[0].adversary}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "3f81a3c6-ed90-4e91-a93e-b1238c78f89e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Unique Groups",
              "description": null,
              "arguments": {
                "__temp": "{% for item in vars.steps.Find_Adversary_in_MITRE_Associated_Groups %}\n{% if item.data[\"hydra:member\"] | length > 0 %}\n{% set _tmp = vars.groups_iri.append(item.data[\"hydra:member\"][0][\"@id\"]) %}\n{% set _tmp = vars.techniques.extend(item.data[\"hydra:member\"][0].techniques | json_query('[].\"@id\"')) %}\n{% set _tmp = vars.software.extend(item.data[\"hydra:member\"][0].software | json_query('[].\"@id\"')) %}\n{% endif %}\n{% endfor %}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "63d36564-fd33-4904-a4f9-96d2ab46d980"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "380396ce-14b0-4c44-82bb-ca2b83db30ae"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Correlated Records",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "relatedMalware": "{{vars.software}}",
                    "relatedThreatActors": "{{vars.groups_iri}}",
                    "relatedATTCKTechniques": "{{vars.techniques}}"
                  }
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/threat_intel_reports",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "9bd6c4cb-6b43-46d3-b4e2-136230520ca9"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Find Adversary in MITRE Associated Groups",
              "targetStep": "/api/3/workflow_steps/3f81a3c6-ed90-4e91-a93e-b1238c78f89e",
              "sourceStep": "/api/3/workflow_steps/7bed58c0-d5e3-460c-9587-c646d5d05f20",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "42974d6a-0d0d-4245-9d0b-82e07db20c9a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find -> Get Unique Groups",
              "targetStep": "/api/3/workflow_steps/63d36564-fd33-4904-a4f9-96d2ab46d980",
              "sourceStep": "/api/3/workflow_steps/3f81a3c6-ed90-4e91-a93e-b1238c78f89e",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ec92a30c-1418-429c-87dd-ad5324bb4a5d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Unique Groups -> Update Correlated Records",
              "targetStep": "/api/3/workflow_steps/9bd6c4cb-6b43-46d3-b4e2-136230520ca9",
              "sourceStep": "/api/3/workflow_steps/63d36564-fd33-4904-a4f9-96d2ab46d980",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "12015e87-df29-4635-86c9-c2517d0ed95a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/7bed58c0-d5e3-460c-9587-c646d5d05f20",
              "sourceStep": "/api/3/workflow_steps/380396ce-14b0-4c44-82bb-ca2b83db30ae",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "bf0f13eb-9731-4d7d-957e-359ce0a46091"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "a89c4164-2099-4bac-a0f7-be58a435ae26",
          "id": 856,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Leaked Cards",
          "aliasName": null,
          "tag": "#Fortinet FortiRecon ACI",
          "description": "Retrieves a list of all leaked cards or specific leaked cards found for the given organization ID and other input parameters you have specified from Fortinet FortiRecon ACI.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1679902122,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/57f7a13c-721b-42cf-843a-5ac8da87c5a6",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Leaked Cards",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "''",
                "params": {
                  "bin": "",
                  "page": "",
                  "size": 10,
                  "type": "",
                  "end_date": "",
                  "start_date": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_leaked_cards",
                "operationTitle": "Get Leaked Cards",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3a8fe80d-7876-40c2-88dc-e4d82a20a85a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "31eb3bad-9507-40bf-9c0a-bb7376660d2d",
                "title": "Fortinet FortiRecon ACI: Get Leaked Cards",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "57f7a13c-721b-42cf-843a-5ac8da87c5a6"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Leaked Cards",
              "targetStep": "/api/3/workflow_steps/3a8fe80d-7876-40c2-88dc-e4d82a20a85a",
              "sourceStep": "/api/3/workflow_steps/57f7a13c-721b-42cf-843a-5ac8da87c5a6",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "5a19060e-28f2-4e4a-a27a-f12f46ceb805"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "aa70c0e9-3734-4e41-9426-285a912d4ed9",
          "id": 485,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Stealers Log",
          "aliasName": null,
          "tag": "#Fortinet FortiRecon ACI",
          "description": "Retrieves a list of all stealer log infections or specific stealer log infections for the given organization ID and other input parameters you have specified from Fortinet FortiRecon ACI.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1679901969,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b0f27be6-85a1-40be-9ee7-255e840943ed",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Stealers Log",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "''",
                "params": {
                  "isp": "",
                  "page": "",
                  "size": 10,
                  "state": "",
                  "domain": "",
                  "country": "",
                  "keyword": "",
                  "end_date": "",
                  "start_date": "",
                  "marketplace": "",
                  "stealer_name": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_stealers_log",
                "operationTitle": "Get Stealers Log",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "4330888e-73a6-4f02-9fc4-c0ecc765dc48"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "c2cf0c4f-7605-4f5a-b3ca-8229830161be",
                "title": "Fortinet FortiRecon ACI: Get Stealers Log",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "b0f27be6-85a1-40be-9ee7-255e840943ed"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Stealers Log",
              "targetStep": "/api/3/workflow_steps/4330888e-73a6-4f02-9fc4-c0ecc765dc48",
              "sourceStep": "/api/3/workflow_steps/b0f27be6-85a1-40be-9ee7-255e840943ed",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ba0eff5d-4449-451a-8a3e-a3e3034b0e98"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "c490cb6e-138c-4afd-bc14-0703892f4319",
          "id": 487,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get IOCs",
          "aliasName": null,
          "tag": "#Fortinet FortiRecon ACI",
          "description": "Retrieves a list of all IOCs or specific IOCs published in ACI reporting for the given organization ID and other input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686131147,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1f0cd4e4-38e7-416d-a719-741ad7fce001",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get IOCs",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "1bb114d2-8376-4b77-b1c0-c9fc93a229c1",
                "params": {
                  "page": "",
                  "size": 10,
                  "end_date": "",
                  "ioc_type": "",
                  "report_id": "2023050919305",
                  "start_date": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_iocs",
                "operationTitle": "Get IOCs",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "d0c439de-9c5e-4829-a7cb-c22699ae0bde"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "851135e7-99f4-4427-b298-936fb58936e4",
                "title": "Fortinet FortiRecon ACI: Get IOCs",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "1f0cd4e4-38e7-416d-a719-741ad7fce001"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get IOCs",
              "targetStep": "/api/3/workflow_steps/d0c439de-9c5e-4829-a7cb-c22699ae0bde",
              "sourceStep": "/api/3/workflow_steps/1f0cd4e4-38e7-416d-a719-741ad7fce001",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "2ebae522-dcdd-4dcf-ada1-4687afdb8a7a"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "eac1c9b2-2a2e-4f9e-b3c8-debd1b39d0a1",
          "id": 488,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Reports",
          "aliasName": null,
          "tag": "#Fortinet FortiRecon ACI",
          "description": "Retrieves a list of all reports or specific reports for the given organization ID and other input parameters you have specified from Fortinet FortiRecon ACI.\nThe data returned by this operation contains a list of all the filtered reports with title, summary, report URL, and the metadata related to the reports. Note that IOCs are not included in the returned data.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1684919260,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7dd5d338-63ac-4273-aab7-3c48a6856c75",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Reports",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "1bb114d2-8376-4b77-b1c0-c9fc93a229c1",
                "params": {
                  "page": "",
                  "size": "",
                  "tags": "",
                  "keyword": "",
                  "end_date": "",
                  "industry": "",
                  "adversary": "",
                  "geography": "",
                  "start_date": "",
                  "report_type": "",
                  "source_category": "",
                  "relevance_rating": "",
                  "source_reliability": "",
                  "information_reliability": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_reports",
                "operationTitle": "Get Reports",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "13d35eee-956c-4465-b40c-dbdfe2fecb02"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "0fd01554-7fbe-4910-9c6c-b9775b2ed789",
                "title": "Fortinet FortiRecon ACI: Get Reports",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7dd5d338-63ac-4273-aab7-3c48a6856c75"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Technical Intelligence Reports",
              "targetStep": "/api/3/workflow_steps/13d35eee-956c-4465-b40c-dbdfe2fecb02",
              "sourceStep": "/api/3/workflow_steps/7dd5d338-63ac-4273-aab7-3c48a6856c75",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "0a4cd7b4-d313-446a-a21d-180f000979e5"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "edcb8a07-438c-48bb-bbe6-1ea0a5609e62",
          "id": 489,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get OSINT Feeds",
          "aliasName": null,
          "tag": "#Fortinet FortiRecon ACI",
          "description": "Retrieves a list of all OSINT feeds or specific OSINT feeds for the given organization ID and other input parameters you have specified from Fortinet FortiRecon ACI.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1679902075,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/27c82c19-804c-4dd5-8ecb-59bc9e249187",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get OSINT Feeds",
              "description": null,
              "arguments": {
                "name": "Fortinet FortiRecon ACI",
                "config": "''",
                "params": {
                  "page": "",
                  "size": 10,
                  "keyword": "",
                  "widget_id": ""
                },
                "version": "1.1.0",
                "connector": "fortinet-fortirecon-aci",
                "operation": "get_osint_feeds",
                "operationTitle": "Get OSINT Feeds",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "3018c765-2f2f-4ed5-ac66-0103b372235e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "a71d2a5b-8d7e-470d-a410-6e0ceb3c3b5d",
                "title": "Fortinet FortiRecon ACI: Get OSINT Feeds",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "27c82c19-804c-4dd5-8ecb-59bc9e249187"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get OSINT Feeds",
              "targetStep": "/api/3/workflow_steps/3018c765-2f2f-4ed5-ac66-0103b372235e",
              "sourceStep": "/api/3/workflow_steps/27c82c19-804c-4dd5-8ecb-59bc9e249187",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "b5244e33-9a2f-4a98-b46b-905a5a9ed4d0"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "efdbaee9-dca4-461c-ada1-658f27d8fbd2",
          "id": 490,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Fortinet",
            "fortinet-fortirecon-aci"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "On Update > Map Adversary to MITRE Groups/Techniques/Softwares",
          "aliasName": null,
          "tag": null,
          "description": "Map adversary to MITRE Groups/Techniques/Softwares on update of adversary in threat report",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1686119431,
          "collection": "/api/3/workflow_collections/7a145247-0a97-4b39-9902-8bd8e0be0e43",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ea4e9934-fea1-4e97-8d62-2bc45836dd7f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Map Adversary to MITRE Records",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": true,
                "workflowReference": "/api/3/workflows/a89c4164-2099-4bac-a0f7-be58a435ae26"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "8768f804-488b-46cd-a815-441d1745b05c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "threat_intel_reports",
                "resources": [
                  "threat_intel_reports"
                ],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "object",
                      "field": "adversary",
                      "value": "",
                      "_value": {
                        "@id": "",
                        "display": "",
                        "itemValue": ""
                      },
                      "operator": "changed"
                    }
                  ]
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/9300bf69-5063-486d-b3a6-47eb9da24872",
              "group": null,
              "uuid": "ea4e9934-fea1-4e97-8d62-2bc45836dd7f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Map Adversary to MITRE Records",
              "targetStep": "/api/3/workflow_steps/8768f804-488b-46cd-a815-441d1745b05c",
              "sourceStep": "/api/3/workflow_steps/ea4e9934-fea1-4e97-8d62-2bc45836dd7f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d733fe57-fa90-4055-929b-4acb1e722191"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "f7066571-1472-4eea-a205-d22a5b1fa26d",
          "id": 857,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fortinet-fortirecon-aci"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "Fortinet",
    "fortinet-fortirecon-aci",
    "dataingestion",
    "create",
    "ingest",
    "fetch"
  ]
}